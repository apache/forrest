<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7-dev">
<meta name="Forrest-skin-name" content="pelt">
<meta-data></meta-data>
<title>SourceTypeAction (content aware pipelines) (v0.7)</title>
<link type="text/css" href="../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../skin/print.css" rel="stylesheet">
<link type="text/css" href="../skin/profile.css" rel="stylesheet">
<script src="../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../favicon.ico">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">apache</a> &gt; <a href="http://forrest.apache.org/">forrest</a><script src="../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://www.apache.org/"><img class="logoImage" alt="Apache" src="../images/apache-forrest.png" title="The Apache Software Foundation"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://forrest.apache.org/"><img class="logoImage" alt="Forrest" src="../images/project-logo.gif" title="Apache Forrest"></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="forrest.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google:');" value="Search the site with google:" size="25" name="q" id="query" type="text">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">Welcome</a>
</li>
<li>
<a class="base-not-selected" href="../contrib.html">Project</a>
</li>
<li class="current">
<a class="base-selected" href="../docs/index.html">0.7 Docs</a>
</li>
<li>
<a class="base-not-selected" href="../docs/howto/index.html">0.7 How-To</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs">
<a class="base-not-selected" href="..">Core</a> | <a class="base-not-selected" href="..">ForrestBot</a> | <a class="base-not-selected" href="..">ForrestBar</a>
</div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript" language="JavaScript"><!--
              document.write("Published: " + document.lastModified);
              //  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
             
             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', '../skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('../skin/images/chapter_open.gif');">Documentation</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a title="" href="../docs/index.html">Overview</a>
</div>
<div class="menuitem">
<a title="" href="../docs/faq.html">FAQs</a>
</div>
<div class="menuitem">
<a title="" href="../docs/changes.html">Changes</a>
</div>
<div class="menuitem">
<a title="" href="../docs/todo.html">Todo</a>
</div>
<div class="menuitem">
<a title="" href="../docs/your-project.html">Using Forrest</a>
</div>
<div class="menuitem">
<a title="" href="../docs/validation.html">XML Validation</a>
</div>
<div class="menuitem">
<a title="" href="../docs/linking.html">Menus and Linking</a>
</div>
<div class="menuitem">
<a title="" href="../docs/searching.html">Searching</a>
</div>
<div class="menuitem">
<a title="" href="../docs/skins.html">Default Skins</a>
</div>
<div class="menuitem">
<a title="" href="../docs/skin-package.html">Skin Packages</a>
</div>
<div class="menuitem">
<a title="" href="../docs/plugins/usingPlugins.html">Plugins</a>
</div>
<div class="menuitem">
<a title="" href="../docs/views.html">Views-dev</a>
</div>
<div class="menuitem">
<a title="" href="../docs/forrest-contract.html">Our Contract</a>
</div>
<div class="menuitem">
<a title="" href="../docs/compliance.html">Standards Compliance</a>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.15', '../skin/')" id="menu_selected_1.1.15Title" class="menutitle" style="background-image: url('../skin/images/chapter_open.gif');">Advanced Topics</div>
<div id="menu_selected_1.1.15" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a title="" href="../docs/build.html">Building Forrest</a>
</div>
<div class="menuitem">
<a title="" href="../docs/catalog.html">Using DTD Catalogs</a>
</div>
<div class="menuitem">
<a title="" href="../docs/sitemap-ref.html">Sitemap Reference</a>
</div>
<div class="menuitem">
<a title="" href="../docs/project-sitemap.html">Project sitemap</a>
</div>
<div class="menuitem">
<a title="" href="../docs/plugins/pluginInfrastructure.html">Plugin Infrastructure</a>
</div>
<div class="menupage">
<div class="menupagetitle">Sourcetype Action</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.16', '../skin/')" id="menu_1.1.16Title" class="menutitle">Other versions</div>
<div id="menu_1.1.16" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs.html">Overview</a>
</div>
<div class="menuitem">
<a title="" href="http://forrest.apache.org/docs/../0.8/">0.8-dev</a>
</div>
<div class="menuitem">
<a title="" href="../docs/index.html">0.7 (current)</a>
</div>
<div class="menuitem">
<a title="" href="http://forrest.apache.org/docs/../0.6/">0.6</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.17', '../skin/')" id="menu_1.1.17Title" class="menutitle">Upgrading</div>
<div id="menu_1.1.17" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/upgrading_07.html">Upgrading to 0.7</a>
</div>
<div class="menuitem">
<a title="" href="../docs/upgrading_06.html">Upgrading to 0.6</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.18', '../skin/')" id="menu_1.1.18Title" class="menutitle">SubProjects</div>
<div id="menu_1.1.18" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/forrestbar.html">ForrestBar</a>
</div>
<div class="menuitem">
<a title="" href="../docs/forrestbot.html">Forrestbot</a>
</div>
<div class="menuitem">
<a title="" href="../docs/forrestbot-web-interface.html">Forrestbot Webapp</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.19', '../skin/')" id="menu_1.1.19Title" class="menutitle">Reference docs</div>
<div id="menu_1.1.19" class="menuitemgroup">
<div onclick="SwitchMenu('menu_1.1.19.1', '../skin/')" id="menu_1.1.19.1Title" class="menutitle">DTD documentation</div>
<div id="menu_1.1.19.1" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/dtd-docs.html">Overview</a>
</div>
<div class="menuitem">
<a title="" href="../docs/document-v20.dtdx.html">document-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/howto-v20.dtdx.html">howto-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/faq-v20.dtdx.html">faq-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/document-v13.dtdx.html">document-v13</a>
</div>
<div class="menuitem">
<a title="" href="../docs/howto-v13.dtdx.html">howto-v13</a>
</div>
<div class="menuitem">
<a title="" href="../docs/faq-v13.dtdx.html">faq-v13</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.19.2', '../skin/')" id="menu_1.1.19.2Title" class="menutitle">Doc samples</div>
<div id="menu_1.1.19.2" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/document-v13.html">document-v13</a>
</div>
<div class="menuitem">
<a title="" href="../docs/document-v20.html">document-v20</a>
</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.20', '../skin/')" id="menu_1.1.20Title" class="menutitle">Older Docs</div>
<div id="menu_1.1.20" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/primer.html">Forrest Primer</a>
</div>
<div class="menuitem">
<a title="" href="../docs/libre-intro.html">Libre</a>
</div>
<div class="menuitem">
<a title="" href="../docs/dreams.html">Dream list</a>
</div>
</div>
</div>
<div id="credit">
<hr>
    This is documentation for current release v0.7
   (<a href="http://forrest.apache.org/docs.html">More</a> ...)</div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="cap.pdf"><img alt="PDF -icon" src="../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<div class="trail">
	        Font size: 
	          &nbsp;<input value="Reset" class="resetfont" title="Reset text" onclick="ndeSetTextSize('reset'); return false;" type="button">      
	          &nbsp;<input value="-a" class="smallerfont" title="Shrink text" onclick="ndeSetTextSize('decr'); return false;" type="button">
	          &nbsp;<input value="+a" class="biggerfont" title="Enlarge text" onclick="ndeSetTextSize('incr'); return false;" type="button">
</div>
<h1>SourceTypeAction (content aware pipelines)</h1>
<div id="motd-area">
    This is documentation for current release v0.7
   (<a href="http://forrest.apache.org/docs.html">More</a> ...)</div>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Introduction">Introduction</a>
</li>
<li>
<a href="#Configuration">Configuration</a>
</li>
<li>
<a href="#Usage">Usage</a>
</li>
</ul>
</div> 
    
<a name="N1000E"></a><a name="Introduction"></a>
<h2 class="underlined_10">Introduction</h2>
<div class="section">
<p>SourceTypeAction assigns a "type" (a string) to an XML file. This is
        done based on information occuring in the header of the XML file, up to the
        document (root) element. This type is then returned to the sitemap as a
        variable with the name 'sourcetype'. If no matching sourcetype could be be
        found, null is returned and thus the contents of the action element will not be
        executed.</p>
<p>SourceTypeAction works by pull-parsing the document and collecting
        information such as the Public Id, the processing instructions, the document
        element local name and namespace, and the xsi:schemaLocation and
        xsi:noNamespaceSchemaLocation attributes. This information is then compared
        with the rules described in the configuration of the SourceTypeAction.</p>
</div> 
    
<a name="N1001B"></a><a name="Configuration"></a>
<h2 class="underlined_10">Configuration</h2>
<div class="section">
<p>The action should be declared and configured in the map:actions
        section of your sitemap. Example:</p>
<pre class="code">&lt;map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0"&gt;
 &lt;map:components&gt;
  &lt;...&gt;
  <strong>&lt;map:actions&gt;
   &lt;map:action name="sourcetype"
      src="org.apache.forrest.sourcetype.SourceTypeAction"&gt;
    &lt;sourcetype name="download-v1.0"&gt;
     &lt;document-declaration
        public-id="-//Acme//DTD Download Documentation V1.0//EN" /&gt;
    &lt;/sourcetype&gt;      
   &lt;/map:action&gt;
  &lt;/map:actions&gt;</strong>
 &lt;/map:components&gt;
 &lt;...&gt;
&lt;/map:sitemap&gt;</pre>
<p>There are other examples in <span class="codefrag">main/webapp/forrest.xmap</span>
</p>
<p>Each sourcetype-tag declares a source type. Inside the sourcetype-tag
        a number of rules can be defined, described below. The sourcetypes will be
        checked in the same order as they are defined in the configuration, the first
        sourcetype of which all rules match will be used.</p>
<p>These are the available rules:</p>
<dl> 
        
<dt>document-declaration</dt> 
        
<dd>This rule checks the public ID. It takes one attribute
          <span class="codefrag">public-id</span>.</dd> 
        
<dt>document-element</dt> 
        
<dd>This rule checks the local name and/or namespace of the document
          element. These are specified with the attributes <span class="codefrag">local-name</span> and
          <span class="codefrag">namespace</span>. At least one of these two is required.</dd> 
        
<dt>processing-instruction</dt> 
        
<dd>This rule checks a processing instruction. It can take two
          attributes: <span class="codefrag">target</span> and <span class="codefrag">data</span>. The target attribute is
          always required, the data attribute is optional.</dd> 
        
<dt>w3c-xml-schema</dt> 
        
<dd>This rule checks the value of the xsi:schemaLocation and
          xsi:noNamespaceSchemaLocation attributes on the document element. These are
          specified with the attributes <span class="codefrag">schema-location</span> and
          <span class="codefrag">no-namespace-schema-location</span>.</dd> 
      
</dl>
</div> 
    
<a name="N10067"></a><a name="Usage"></a>
<h2 class="underlined_10">Usage</h2>
<div class="section">
<p>The source of which the sourcetype must be defined must be specified
        using the 'src' attribute on the map:act element.</p>
<pre class="code">&lt;map:act type="sourcetype" src="{1}"&gt;
...
&lt;/map:act&gt;</pre>
<p>See a real-life example in the advanced section of the
        <a href="your-project.html#adding_new_content_type_2">Using Forrest</a>
        document.
      </p>
</div> 
  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
 Copyright &copy; 2002-2005 The Apache Software Foundation.</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
