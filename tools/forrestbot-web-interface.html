<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.9-dev">
<meta name="Forrest-skin-name" content="pelt">
<title>Forrestbot Web Interface</title>
<link type="text/css" href="../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../skin/print.css" rel="stylesheet">
<link type="text/css" href="../skin/profile.css" rel="stylesheet">
<script src="../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../favicon.ico">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">apache</a> &gt; <a href="http://forrest.apache.org/">forrest</a><script src="../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://www.apache.org/"><img class="logoImage" alt="Apache" src="../images/apache-forrest.png" title="The Apache Software Foundation"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://forrest.apache.org/"><img class="logoImage" alt="Forrest" src="../images/project-logo.gif" title="Apache Forrest"></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="forrest.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="../index.html">Welcome</a>
</li>
<li>
<a class="unselected" href="../contrib.html">Developers</a>
</li>
<li>
<a class="unselected" href="../versions/index.html">Versioned Docs</a>
</li>
<li>
<a class="unselected" href="../pluginDocs/index.html">Plugins</a>
</li>
<li class="current">
<a class="selected" href="../tools/index.html">Tools</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', '../skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('../skin/images/chapter_open.gif');">Tools</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../tools/index.html">Index</a>
</div>
<div class="menuitem">
<a href="../tools/forrestbar.html">ForrestBar</a>
</div>
<div class="menuitem">
<a href="../tools/forrestbot.html">Forrestbot</a>
</div>
<div class="menupage">
<div class="menupagetitle">Forrestbot Webapp</div>
</div>
<div class="menuitem">
<a href="../tools/eclipse.html">Eclipse Plugin</a>
</div>
<div class="menuitem">
<a href="../tools/xxe.html">XXE-Editor</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2">
<a href="http://us.apachecon.com/"><img border="0" title="ApacheCon US 2007" alt="ApacheCon US 2007 - logo" src="http://apache.org/ads/ApacheCon/2007-usa-125x125.png" style="width: 125px;height: 125px;"></a><a href="http://www.ossummit.com/"><img border="0" title="OS Summit Asia 2007" alt="OS Summit Asia 2007 - logo" src="http://www.ossummit.com/ads/ossummit_button_3.jpg" style="width: 125px;height: 125px;"></a><a href="http://eu.apachecon.com/"><img border="0" title="ApacheCon Europe 2008" alt="ApacheCon Europe 2008 - logo" src="http://apache.org/ads/ApacheCon/2008-europe-125x125.png" style="width: 125px;height: 125px;"></a>
</div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="forrestbot-web-interface.pdf"><img alt="PDF -icon" src="../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<div class="trail">Font size: 
	          &nbsp;<input value="Reset" class="resetfont" title="Reset text" onclick="ndeSetTextSize('reset'); return false;" type="button">      
	          &nbsp;<input value="-a" class="smallerfont" title="Shrink text" onclick="ndeSetTextSize('decr'); return false;" type="button">
	          &nbsp;<input value="+a" class="biggerfont" title="Enlarge text" onclick="ndeSetTextSize('incr'); return false;" type="button">
</div>
<h1>Forrestbot Web Interface</h1>
<div id="front-matter">
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Build">Build</a>
</li>
<li>
<a href="#Requirements">Requirements</a>
</li>
<li>
<a href="#Installation">Installation</a>
</li>
<li>
<a href="#FAQ">FAQ</a>
<ul class="minitoc">
<li>
<a href="#The+build+and%2For+deploy+commands+don%27t+seem+to+work">The build and/or deploy commands don't seem to work</a>
</li>
<li>
<a href="#Can+I+do+anything+with+this+besides+just+running+the%0A++++++++forrestbot%3F">Can I do anything with this besides just running the
        forrestbot?</a>
</li>
</ul>
</li>
<li>
<a href="#TODO+Wishlist">TODO Wishlist</a>
</li>
</ul>
</div>
</div>
    
<p>
      This webapp implements a website staging application for sites built with
      Apache Forrest. The webapp hosts HTML for a number of managed websites.
      The user can regenerate these sites at will. Once the user is satisfied
      with the site, they may 'deploy' the site, making it live.
    </p>
    
<a name="N10010"></a><a name="Build"></a>
<h2 class="underlined_10">Build</h2>
<div class="section">
<p>
        To build the webapp from source, you need
        <a href="http://maven.apache.org/">Apache Maven</a>
        installed. From a command prompt, go to the
        <span class="codefrag">forrest/tools/forrestbot/webapp</span> directory and execute
        "<span class="codefrag">maven war</span>".
      </p>
</div>
    
<a name="N10024"></a><a name="Requirements"></a>
<h2 class="underlined_10">Requirements</h2>
<div class="section">
<ul>
        
<li>Forrest</li>
        
<li>A servlet container such as <a href="http://jakarta.apache.org/tomcat">Apache Tomcat</a>
</li>
        
<li>Directories for:</li>
        
<ul>
          
<li>forrestbot buildfiles</li>
          
<li>source and working files</li>
          
<li>log files</li>
          
<li>built websites (this is not their deployed location)</li>
        
</ul>
        
<li>A webserver to view the sites in the build directory</li>
      
</ul>
<p>
        The server does not need local access to the sites' source nor final
        deployed location. The buildfiles configure the transfer of those files.
      </p>
</div>
    
<a name="N1004F"></a><a name="Installation"></a>
<h2 class="underlined_10">Installation</h2>
<div class="section">
<div class="note">
<div class="label">Note</div>
<div class="content">
        Most of this configuration is related to the
        <a href="http://www.opensymphony.com/osuser/">OpenSymphony
        OSUser</a> authentication layer.
      </div>
</div>
<ol>
        
<li>Extract the war to an empty directory</li>
        
<li>Modify welcome.local.html</li>
        
<li>Modify WEB-INF/classes/osuser.xml if you want to use an
        authenticator other than XML files</li>
        
<li>Modify projects.xml, groups.xml, and users.xml (all in
        WEB-INF/classes) according to your needs</li>
        
<li>Optionally modify logging via WEB-INF/classes/log4j.properties</li>
        
<li>Modify WEB-INF/classes/settings.properties according to the server's
        specific setup</li>
        
<li>Deploy the webapp in Tomcat or some other servlet container (you may
        want to repackage the war file)</li>
        
<li>Make sure tomcat has permissions to write in forrestbot's build,
        work, and log directories.</li>
      
</ol>
<p>
        Optional: set up "cron jobs" to execute forrestbot. This is completely
        independent of the forrestbot web interface, but is often useful. A
        suggested practice is to build the sites regularly and deploy them as
        desired through the web interface.
      </p>
</div>
    
<a name="N1007B"></a><a name="FAQ"></a>
<h2 class="underlined_10">FAQ</h2>
<div class="section">
<a name="N10081"></a><a name="The+build+and%2For+deploy+commands+don%27t+seem+to+work"></a>
<h3 class="underlined_5">The build and/or deploy commands don't seem to work</h3>
<div class="warning">
<div class="label">Warning</div>
<div class="content">
          The only environment variable available is FORREST_HOME, which is set
          by forrest-home in the settings.properties file. Use a wrapper script
          (see below) if you need other environment variables.
        </div>
</div>
<p>
          Currently forrestbot only logs the forrest part of it's execution, not
          the whole thing. And the web interface starts a forrestbot process and
          doesn't watch it's progress directly.
        </p>
<p>
          Set debug-exec=true in settings.properties and make sure
          log4j.properties logs at the DEBUG level. This will log all the thread
          output.
        </p>
<p>
          Then look at the debugging output for the command executed and the
          working directory used. Log into the server as the use the Tomcat
          server uses and cd to the working directory and then execute the
          command. This will fairly accurately simulate what the web interface
          does.
        </p>
<a name="N10094"></a><a name="Can+I+do+anything+with+this+besides+just+running+the%0A++++++++forrestbot%3F"></a>
<h3 class="underlined_5">Can I do anything with this besides just running the
        forrestbot?</h3>
<p>
          Sure. Create a wrapper script and specify it as forrest-exec in
          settings.properties. Here's an example:
        </p>
<pre class="code">#!/bin/bash

# get env vars
. /home/user/.profile

# group writable for easier sharing of files with others who run forrestbot
umask g+w

# you can preprocess something here
xmlfile=$2
if [ "${xmlfile##*.}" = "xml" ]                # everything after last .
then
    target=$3
    if [ "$target" != "deploy" ]                # don't run preprocess task on a deploy
    then
        projectTarget=${xmlfile%.*}               # everything before last .
        # do something special for $projectTarget here
    fi
else
        echo "Syntax: forrest_wrapper.sh -f myapp.xml [build|deploy|...]"
        exit
fi

# run forrest(bot) with all the parameters
forrest $*

# you can postprocess something here</pre>
</div>
    
<a name="N100A3"></a><a name="TODO+Wishlist"></a>
<h2 class="underlined_10">TODO Wishlist</h2>
<div class="section">
<ul>
        
<li>seperate authorization of 'build' and 'deploy'</li>
        
<li>log everything, not just the build</li>
        
<li>view old log files</li>
        
<li>ability to reload all config files on the fly</li>
        
<li>put date at top of viewlog_body page</li>
      
</ul>
</div>
  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2002-2007 <a href="http://www.apache.org/licenses/">The Apache Software Foundation.</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
