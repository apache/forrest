<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.6-dev">
<meta name="Forrest-skin-name" content="crust">
<title>Generate an ASF mirrors page using interactive web form</title>
<link type="text/css" href="../skin/page.css" rel="stylesheet">
<link type="text/css" href="../skin/forrest.css" rel="stylesheet">
<link rel="shortcut icon" href="../favicon.ico">
<script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script><script src="../skin/menu.js" language="javascript" type="text/javascript"></script>
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<table width="100%" border="0" cellpadding="0" cellspacing="0" class="header">
<tr>
<td>
<div class="headerlogo">
<a href="http://www.apache.org/"><img class="logoImage" alt="Apache" src="../images/apache-forrest.png"></a>
</div>
</td><td align="center">
<div class="headerlogo">
<a href="http://forrest.apache.org/"><img class="logoImage" alt="Forrest" src="../images/project-logo.gif"></a>
</div>
</td><td valign="top" rowspan="2" align="right" class="search">
<form target="_blank" action="http://www.google.com/search" method="get">
<table border="0" cellpadding="0" cellspacing="0" class="dialog">
<tr>
<td height="10" class="border" colspan="3"></td>
</tr>
<tr>
<td height="8" colspan="3"></td>
</tr>
<tr>
<td></td><td nowrap="nowrap"><input value="forrest.apache.org" name="as_sitesearch" type="hidden"><input size="15" name="as_q" id="query" type="text">
			&nbsp;
			<input name="Search" value="Search" type="submit">
<br>
			the Apache Forrest site
			
			
		      </td><td></td>
</tr>
<tr>
<td height="7" colspan="3"></td>
</tr>
<tr>
<td class="search border bottom-left SBBL"></td><td class="search border bottomborder"></td><td class="search border bottom-right SBBR"></td>
</tr>
</table>
</form>
</td><td height="10" width="10" align="right"><span class="textheader">Forrest</span></td>
</tr>
<tr>
<td class="tabstrip" colspan="4">
<table border="0" cellpadding="0" cellspacing="0" class="tab">
<tr>
<td class="tab pre-separator"></td><td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="tab unselected top-left TUTL"></td><td class="tab unselected corner"><a class="base-not-selected" href="../index.html">Welcome</a></td><td class="tab unselected top-right TUTR"></td>
</tr>
<tr>
<td class="spacer" colspan="3"></td>
</tr>
</table>
</td><td class="tab separator"></td><td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="tab unselected top-left TUTL"></td><td class="tab unselected corner"><a class="base-not-selected" href="../contrib.html">Project</a></td><td class="tab unselected top-right TUTR"></td>
</tr>
<tr>
<td class="spacer" colspan="3"></td>
</tr>
</table>
</td><td class="tab separator"></td><td>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="tab unselected top-left TUTL"></td><td class="tab unselected corner"><a class="base-not-selected" href="../docs/your-project.html">Documentation</a></td><td class="tab unselected top-right TUTR"></td>
</tr>
<tr>
<td class="spacer" colspan="3"></td>
</tr>
</table>
</td><td class="tab separator"></td><td class="tab selected top-left TSTL"></td><td class="tab selected"><a class="base-selected" href="../howto/index.html">How-To</a></td><td class="tab selected top-right TSTR"></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="level2tabstrip" colspan="2"></td><td class="datenote level2tabstrip" colspan="2">
<div class="published">
<script type="text/javascript" language="JavaScript"><!--
              document.write("Published: " + document.lastModified);
              //  --></script>
</div>
</td>
</tr>
</table>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table class="menuarea" cellspacing="0" cellpadding="0">
<tr>
<td width="6px" valign="top">
<table border="0" cellpadding="0" cellspacing="0" class="leftpagemargin">
<tr>
<td class="subborder trail">&nbsp;</td>
</tr>
</table>
</td><td class="dialog">
<div class="menu">
<div onclick="SwitchMenu('menu_selected_1.1')" id="menu_selected_1.1Title" class="menutitle">How-To</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup">
<div class="menuitem">
<a href="../howto/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../howto/howto-howto.html">Write a How-to</a>
</div>
<div class="menupage">
<div class="menupagetitle">Download mirror</div>
</div>
<div class="menuitem">
<a href="../howto/howto-pdf-tab.html">Create tab PDF</a>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td></td><td>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="border bottom-left"></td><td class="border bottomborder"></td><td class="border bottom-right"></td>
</tr>
</table>
</td>
</tr>
<tr>
<td colspan="2" height="10"></td>
</tr>
</table>
</td><td width="100%" valign="top">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td class="subborder trail">
	         &nbsp;
			 <a href="http://www.apache.org/">apache</a> &gt; <a href="http://forrest.apache.org/">forrest</a><script src="../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>&nbsp;
             </td><td nowrap="nowrap" align="right" class="subborder trail">
			 &nbsp;
	       
	        Font size: 
	          &nbsp;<input value="Reset" class="resetfont" title="Reset text" onclick="ndeSetTextSize('reset'); return false;" type="button">      
	          &nbsp;<input value="-a" class="smallerfont" title="Shrink text" onclick="ndeSetTextSize('decr'); return false;" type="button">
	          &nbsp;<input value="+a" class="biggerfont" title="Enlarge text" onclick="ndeSetTextSize('incr'); return false;" type="button"></td>
</tr>
<tr>
<td colspan="2" align="left">
<div class="content">
<table class="title">
<tr>
<td valign="middle">
<h1>Generate an ASF mirrors page using interactive web form</h1>
</td>
<div id="skinconf-txtlink"></div>
<td nowrap="nowrap" width="40" align="center"><a class="dida" href="howto-asf-mirror.pdf"><img alt="PDF" src="../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a></td>
</tr>
</table>
<div class="abstract">Use ihtml (interpreted html) to include html form elements
    into a forrest-generated html page. For example, this enables building
    automated download mirror pages for ASF project websites.
    </div>
<ul class="minitoc">
<li>
<a href="#Intended Audience">Intended Audience</a>
</li>
<li>
<a href="#Purpose">Purpose</a>
</li>
<li>
<a href="#Prerequisites">Prerequisites</a>
</li>
<li>
<a href="#Steps">Steps</a>
<ul class="minitoc">
<li>
<a href="#cgi">Add the mirrors.cgi as a raw file</a>
</li>
<li>
<a href="#ihtml">Add the mirrors.ihtml to xdocs directory</a>
</li>
<li>
<a href="#menu">Add a menu entry for Download</a>
</li>
<li>
<a href="#link">Cause the mirrors.ithml to be processed as an extra file</a>
</li>
<li>
<a href="#forrest">Run 'forrest' to build your site</a>
</li>
<li>
<a href="#explain">Explanation of the process</a>
</li>
</ul>
</li>
</ul>
  
<header>
    

    
<a name="N10016"></a><a name="Overview"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h3">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h3>Overview</h3>
</td><td></td>
</tr>
<tr class="heading ">
<td class="bottom-left"></td><td class="bottomborder"></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<div class="section">
<p>Use ihtml (interpreted html) to include html form elements
    into a forrest-generated html page. For example, this enables building
    automated download mirror pages for ASF project websites.
    </p>
</div>

    
<last-modified-content-date date="2004-07-19"></last-modified-content-date>
  
</header>

  
<a name="N10021"></a><a name="Intended Audience"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h3">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h3>Intended Audience</h3>
</td><td></td>
</tr>
<tr class="heading ">
<td class="bottom-left"></td><td class="bottomborder"></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<div class="section">
    
<ul>
      
<li>Any Apache project that uses Forrest to generate their website
        will need to have a mirrors page.</li>
      
<li>Also anyone interested in the use of ihtml to embed html form
        elements into a generated Forrest page.</li>
    
</ul>
  
</div>

  
<a name="N10030"></a><a name="Purpose"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h3">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h3>Purpose</h3>
</td><td></td>
</tr>
<tr class="heading ">
<td class="bottom-left"></td><td class="bottomborder"></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<div class="section">
    
<p>All Apache projects use dynamically generated download pages
    which determine the closest mirror and provide an interactive list of
    the current alternative mirrors.
    This HowTo describes the procedure to generate the template page
    that is utilised by the mirrors.cgi script. The processed page
    includes html "form" elements that are not included in the xdocs DTDs.
    </p>
    
<p>This process has many exciting applications, beyond the scope of
     this document.
    </p>
  
</div>

  
<a name="N1003C"></a><a name="Prerequisites"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h3">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h3>Prerequisites</h3>
</td><td></td>
</tr>
<tr class="heading ">
<td class="bottom-left"></td><td class="bottomborder"></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<div class="section">
    
<ul>
      
<li>Followed the documentation about
      <a href="http://www.apache.org/~bodewig/mirror.html">Making your
      downloads mirrorable</a> and
      <a href="http://www.apache.org/dev/mirrors.html">Apache Mirroring Information</a>
      .
      </li>
      
<li>Established your ASF distribution space as described.</li>
      
<li>Already building your project website with Forrest.</li>
    
</ul>
  
</div>

  
<a name="N10056"></a><a name="Steps"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h3">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h3>Steps</h3>
</td><td></td>
</tr>
<tr class="heading ">
<td class="bottom-left"></td><td class="bottomborder"></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<div class="section">
    
<a name="N1005B"></a><a name="cgi"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h4">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h4>Add the mirrors.cgi as a raw file</h4>
</td><td></td>
</tr>
<tr class="subheading">
<td class="bottom-left"></td><td></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<p>As explained in the mirrors document, there will be a two-line CGI
      wrapper script at the top-level of your website called
      <span class="codefrag">mirrors.cgi</span>
</p>
<p>Utilising the Forrest concept of raw un-processed content,
       add the file as <span class="codefrag">src/documentation/mirrors.cgi</span>
       (copy the Forrest project's
        <a class="external" href="http://svn.apache.org/repos/asf/forrest/trunk/src/documentation/content/mirrors.cgi">mirrors.cgi</a>)
      </p>

    
<a name="N10071"></a><a name="ihtml"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h4">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h4>Add the mirrors.ihtml to xdocs directory</h4>
</td><td></td>
</tr>
<tr class="subheading">
<td class="bottom-left"></td><td></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<p>This file contains the html content of your mirror page, including
        the html form elements which drive the mirror selection. It also
        contains the specific tokens that are interpreted by the mirrors.cgi
        script to add the list of mirrors and select the closest.
      </p>
<p>
        Add the file as <span class="codefrag">src/documentation/xdocs/mirrors.html</span>
        (Use the Forrest project's
        <a class="external" href="http://svn.apache.org/repos/asf/forrest/trunk/src/documentation/content/xdocs/mirrors.ihtml">mirrors.html</a>
        as a template and edit it to suit.)
      </p>

    
<a name="N10085"></a><a name="menu"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h4">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h4>Add a menu entry for Download</h4>
</td><td></td>
</tr>
<tr class="subheading">
<td class="bottom-left"></td><td></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<p>Add an entry to your site.xml navigation. For example ...
      </p>
<pre class="code">
 &lt;about label="About"&gt;
  &lt;index label="Index" href="index.html"/&gt;
  &lt;license label="License" href="license.html"/&gt;
  &lt;download label="Download" href="http://forrest.apache.org/mirrors.cgi"/&gt;
  &lt;download_html href="mirrors.html"/&gt;&lt;!-- so the page is part of a tab --&gt;
  ...</pre>

    
<a name="N10093"></a><a name="link"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h4">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h4>Cause the mirrors.ithml to be processed as an extra file</h4>
</td><td></td>
</tr>
<tr class="subheading">
<td class="bottom-left"></td><td></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<p>Forrest gathers the links that are to be crawled, by reading site.xml
        and by finding any other internal links in the actual documents.
        There is no link to mirrors.html because it is an extra file that needs
        to be generated and skinned, but not linked in any way.
      </p>
<p>The Cocoon command-line interface
        (<a class="external" href="http://cocoon.apache.org/2.1/userdocs/offline/">CLI</a>)
        to the rescue. Add an entry to your project's cli.xconf by copying the
        default one from
        <span class="codefrag">$FORREST_HOME/context/WEB-INF/cli.xconf</span> to your
        <span class="codefrag">src/documentation/conf/</span> directory (or wherever
        ${forrest.conf-dir} points). Add the following entry ...
      </p>
<pre class="code">
&lt;uris name="mirrors" follow-links="false"&gt;
  &lt;uri type="append" src="mirrors.html"/&gt;
&lt;/uris&gt;</pre>

    
<a name="N100AE"></a><a name="forrest"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h4">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h4>Run 'forrest' to build your site</h4>
</td><td></td>
</tr>
<tr class="subheading">
<td class="bottom-left"></td><td></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<p>
        That is all that you need to do, Forrest will take care of it from
        there. Run the '<span class="codefrag">forrest</span>' command. The mirrors.html page
        will be generated with the skin applied.
      </p>

    
<a name="N100BB"></a><a name="explain"></a>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="h4">
<tbody>
<tr>
<td height="10" width="9"></td><td>
<h4>Explanation of the process</h4>
</td><td></td>
</tr>
<tr class="subheading">
<td class="bottom-left"></td><td></td><td class="bottom-right"></td>
</tr>
</tbody>
</table>
<p>Forrest automatically reads ihtml files and transforms the html source
      to the forrest xdocs intermediate format. It mainly detects heading
      elements (h1, h2, etc.) and converts them to "sections". The remainder
      of the html elements are copied over as-is. With this technique the
      html form elements are copied over to the output.
      </p>
  
</div>

</div>
</td>
</tr>
</table>
</td>
</tr>
</table>
<table>
<tr>
<td>
<br>
<br>
</td>
</tr>
</table>
<table class="footer">
<tr>
<td colspan="2" align="center" width="90%"><span class="footnote"><a href="http://www.apache.org/licenses/">
                Copyright &copy; 2002-2004&nbsp;
                The Apache Software Foundation.</a>
            All rights reserved.
            <br>
<script type="text/javascript" language="JavaScript"><!--
              document.write(" - "+"Last Published: " + document.lastModified);
              //  --></script></span></td><td nowrap="nowrap" align="right" class="logos"></td>
</tr>
</table>
</body>
</html>
