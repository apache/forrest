<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The ForrestBot</title>
<link type="text/css" href="skin/page.css" rel="stylesheet">
<link rel="shortcut icon" href="favicon.ico">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Navigation Path ==================-->
<table summary="navigation path" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td nowrap="nowrap" valign="middle" bgcolor="#CFDCED" height="20"><img height="1" width="5" alt="" src="skin/images/spacer.gif" class="spacer"><!--===== breadcrumb trail (javascript-generated) ====--><font size="2" face="Arial, Helvetica, Sans-serif"><a href="http://www.apache.org/">apache</a> &gt; <a href="http://forrest.apache.org/">forrest.apache</a><script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script></font></td>
</tr>
<tr>
<td bgcolor="#4C6C8F" height="2"><img height="2" width="2" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
<!--================= end Navigation Path ==================-->
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td bgcolor="#294563"><a href="http://xml.apache.org/"><img class="logoImage" alt="Apache XML" src="images/group-logo.gif"></a></td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" align="center" bgcolor="#294563"><a href="http://forrest.apache.org/"><img class="logoImage" alt="Forrest" src="images/project-logo.gif"></a></td>
<!--================= end Project Logo ==================-->
<!--================= start Search ==================--><td valign="top" rowspan="2" bgcolor="#294563">
<form target="_blank" action="http://www.google.com/search" method="get">
<table summary="search" border="0" cellspacing="0" cellpadding="0" bgcolor="#4C6C8F">
<tr>
<td colspan="3"><img height="10" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap"><input value="forrest.apache.org" name="as_sitesearch" type="hidden"><input size="15" name="as_q" id="query" type="text"><img height="1" width="5" alt="" src="skin/images/spacer.gif" class="spacer"><input name="Search" value="Search" type="submit">
<br>
<font face="Arial, Helvetica, Sans-serif" size="2" color="white">
                          the Apache XML site
                          
                          
                        </font></td><td><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img alt="" border="0" height="10" width="9" src="skin/images/search-left.gif"></td><td><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td><img alt="" border="0" height="10" width="9" src="skin/images/search-right.gif"></td>
</tr>
</table>
</form>
</td>
<!--================= end Search ==================--><td bgcolor="#294563"><img height="10" width="10" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" bgcolor="#294563" colspan="2">
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="6"><img alt="" height="8" width="6" src="skin/images/spacer.gif"></td><td valign="bottom">
<table summary="selected tab" style="height: 1.8em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="skin/images/tabSel-left.gif"></td><td valign="middle" bgcolor="#4C6C8F"><font color="#ffffff" size="2" face="Arial, Helvetica, Sans-serif"><b><a class="base-selected" href="index.html">Home</a></b></font></td><td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="skin/images/tabSel-right.gif"></td>
</tr>
</table>
</td><td width="6"><img alt="" height="8" width="6" src="skin/images/spacer.gif"></td><td valign="bottom">
<table summary="non selected tab" style="height: 1.6em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="skin/images/tab-left.gif"></td><td valign="middle" bgcolor="#B2C4E0"><a class="base-not-selected" href="community/index.html">Community</a></td><td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="skin/images/tab-right.gif"></td>
</tr>
<tr>
<td colspan="3" height="1"></td>
</tr>
</table>
</td><td width="6"><img alt="" height="8" width="6" src="skin/images/spacer.gif"></td><td valign="bottom">
<table summary="non selected tab" style="height: 1.6em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="skin/images/tab-left.gif"></td><td valign="middle" bgcolor="#B2C4E0"><a class="base-not-selected" href="community/howto/index.html">How-to</a></td><td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="skin/images/tab-right.gif"></td>
</tr>
<tr>
<td colspan="3" height="1"></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td><td bgcolor="#294563"></td>
</tr>
<tr>
<td height="10" bgcolor="#4C6C8F" colspan="4"></td>
</tr>
</table>
<!--================= end Banner ==================-->
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<td rowspan="3" valign="top">
<table summary="blue line" border="0" cellpadding="0" cellspacing="0">
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td bgcolor="#CFDCED"><font color="#4C6C8F" size="4" face="Arial, Helvetica, Sans-serif">&nbsp;</font></td>
</tr>
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td>
<!--================= end left top NavBar ==================--><td bgcolor="#294563"><img width="1" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap" valign="top" bgcolor="#4C6C8F">
<!--================= start Menu items ==================-->
<div class="menu">
<ul>
<li>
<font color="#CFDCED">About</font>
<ul>
    
<li>
<a href="index.html">Index</a>
</li>
    
<li>
<a href="license.html">License</a>
</li>
    
<li>
<a class="external" href="http://www.apache.org/dyn/closer.cgi/xml/forrest/">Download</a>
</li>
    
<li>
<a href="who.html">Who we are</a>
</li>
    
<li>
<a href="faq.html">FAQs</a>
</li>
    
<li>
<a href="changes.html">Changes</a>
</li>
    
    
<li>
<a href="todo.html">Todo</a>
</li>
    
<li>
<a href="live-sites.html">Example sites</a>
</li>
  
</ul>
</li>
<li>
<font color="#CFDCED">Documentation</font>
<ul>
    
<li>
<a href="your-project.html">Using Forrest</a>
</li>
    
<li>
<a href="validation.html">XML Validation</a>
</li>
    
<li>
<a href="linking.html">Menus and Linking</a>
</li>
    
<li>
<a href="sitemap-ref.html">Sitemap Reference</a>
</li>
    
<li>
<a href="searching.html">Searching</a>
</li>
    
<li>
<a href="skin-package.html">Skin Packages</a>
</li>
    
    
<li>
<a href="forrest-contract.html">Our Contract</a>
</li>
    
<li>
<a href="compliance.html">Standards Compliance</a>
</li>
    
<li>
<a href="dtd-docs.html">DTD documentation</a>
</li>
    
<li>
<a href="catalog.html">Using DTD Catalogs</a>
</li>
    
<li>
<a href="cap.html">Sourcetype Action</a>
</li>
    
<li>
<a href="oowriter.html">OpenOffice Writer docs</a>
</li>    
    
<li>
<a href="forrestbar.html">The ForrestBar</a>
</li>
    
<li>
<a href="forrestbot.html">Forrestbot (CVS)</a>
</li>
    
<li>
<span class="sel"><font color="#ffcc00">Forrestbot (stable)</font></span>
</li>
    
    
<li>
<a href="upgrading_06.html">Upgrading to 0.6</a>
</li>
    
<li>
<a href="upgrading_05.html">Upgrading to 0.5</a>
</li>
  
</ul>
</li>
<li>
<font color="#CFDCED">Older Docs</font>
<ul>
    
<li>
<a href="primer.html">Forrest Primer</a>
</li>
    
<li>
<a href="libre-intro.html">Libre</a>
</li>
    
<li>
<a href="dreams.html">Dream list</a>
</li>
  
</ul>
</li>
<li>
<font color="#CFDCED">Some Samples</font>
<ul>
    
<li>
<a href="document-v12.html">document-v12</a>
</li>
    
<li>
<a href="wiki-sample.html">Wiki Reference</a>
</li>
 
</ul>
</li>
<li>
<font color="#CFDCED">Getting Involved</font>
<ul>
    
<li>
<a href="contrib.html">Contributing</a>
</li>
    
<li>
<a href="build.html">Building Forrest</a>
</li>
    
<li>
<a class="external" href="http://svn.apache.org/viewcvs.cgi/forrest/trunk/?root=Apache-SVN">Browse SVN</a>
</li>
    
<li>
<a href="mail-lists.html">Mail lists</a>
</li>
    
<li>
<a href="mail-archives.html">Mail Archives</a>
</li>
    
<li>
<a class="external" href="http://issues.cocoondev.org/jira/secure/BrowseProject.jspa?id=10000">Bugs and Issues</a>
</li>
    
<li>
<a href="forrest-issues.html">Open Issues</a>
</li>
  
</ul>
</li>
<li>
<font color="#CFDCED">Related projects</font>
<ul>
    
<li>
<a class="external" href="http://gump.apache.org/">Apache Gump</a>
</li>
    
<li>
<a class="external" href="http://cocoon.apache.org/">Apache Cocoon</a>
</li>
    
<li>
<a class="external" href="http://cocoon.apache.org/lenya/">Apache Lenya</a>
</li>
    
<li>
<a class="external" href="http://www.krysalis.org/">Krysalis Centipede</a>
</li>
  
</ul>
</li>
</ul>
</div>
<!--================= end Menu items ==================-->
</td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="skin/images/spacer.gif" class="spacer"></td><td bgcolor="#294563"><img width="1" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" align="left" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="skin/images/menu-left.gif"></td><td bgcolor="#4C6C8F"><img height="10" width="10" alt="" src="skin/images/spacer.gif" class="spacer"></td><td valign="bottom" align="right" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="skin/images/menu-right.gif"></td>
</tr>
<tr>
<td height="1" bgcolor="#294563"><img width="1" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<!--================= start middle NavBar ==================-->
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td align="left" width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td align="left" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="skin/images/spacer.gif" class="spacer"></td><td align="right" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="skin/images/spacer.gif" class="spacer"></td><td width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end middle NavBar ==================-->
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td><td colspan="2" align="left" width="100%">
<div class="content">
<table class="title" summary="">
<tr>
<td valign="middle">
<h1>The ForrestBot</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="forrestbot-old.pdf"><img alt="PDF" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a></td>
</tr>
</table>
<p>This document explains how the Forrest project can be used to
      centrally build the documentation for different projects. It also explains
      which pieces in the Forrest distribution form this
      functionality, and how they could be extended in the future.</p>
<ul class="minitoc">
<li>
<a href="#Foreword">Foreword</a>
</li>
<li>
<a href="#Using+the+Forrestbot">Using the Forrestbot</a>
<ul class="minitoc">
<li>
<a href="#Setting+up+the+centralized+service">Setting up the centralized service</a>
</li>
<li>
<a href="#Describing+your+project+to+the+bot">Describing your project to the bot</a>
<ul class="minitoc">
<li>
<a href="#Setting+bot-wide+defaults">Setting bot-wide defaults</a>
</li>
</ul>
</li>
<li>
<a href="#Checking+logs+and+getting+them+by+mail">Checking logs and getting them by mail</a>
</li>
</ul>
</li>
<li>
<a href="#Current+supported+workstages+and+types.">Current supported workstages and types.</a>
<ul class="minitoc">
<li>
<a href="#%0A++++++++++">
          &lt;prepare&gt;
        </a>
</li>
<li>
<a href="#%0A++++++++++-N10194">
          &lt;get-src ...&gt;
        </a>
<ul class="minitoc">
<li>
<a href="#%0A++++++++++++">
            &lt;get-src type="cvs"&gt;
          </a>
</li>
<li>
<a href="#%0A++++++++++++-N101CB">
            &lt;get-src type="local-copy"&gt;
          </a>
</li>
</ul>
</li>
<li>
<a href="#%0A++++++++++-N101EA">
          &lt;generate&gt;
        </a>
</li>
<li>
<a href="#%0A++++++++++-N10202">
          &lt;deploy ...&gt;
        </a>
<ul class="minitoc">
<li>
<a href="#%0A++++++++++++-N1020B">
            &lt;deploy type="scp"&gt;
          </a>
</li>
<li>
<a href="#%0A++++++++++++-N10238">
            &lt;deploy type="local-copy"&gt;
          </a>
</li>
<li>
<a href="#%0A++++++++++++-N1024D">
            &lt;deploy type="ftp"&gt;
          </a>
</li>
</ul>
</li>
<li>
<a href="#%0A++++++++++-N1027F">
          &lt;cleanup&gt;
        </a>
</li>
</ul>
</li>
<li>
<a href="#ForrestBot+design">ForrestBot design</a>
<ul class="minitoc">
<li>
<a href="#The+Ant+play">The Ant play</a>
</li>
<li>
<a href="#Adding+features+to+the+bot+-+The+meta+template">Adding features to the bot - The meta template</a>
</li>
</ul>
</li>
</ul>
    
<div class="frame warning">
<div class="label">Warning</div>
<div class="content">This documentation applies to the forrestbot included with Forrest 0.5.1 and previous releases.
      The next version of forrest will include a new forrestbot, which has some documentation <a href="forrestbot.html">here</a>.
    </div>
</div>
    
<a name="N10017"></a><a name="Foreword"></a>
<h3>Foreword</h3>
<div style="margin-left: 0 ; border: 2px">
<p>This document explains how the Forrest project can be used to
      centrally build the documentation for different projects.
      It also explains which pieces in the Forrest distribution form this
      functionality, and how they could be extended in the future.</p>
<p>See some related documents:</p>
<ul>
        
<li>
<a href="forrest-contract.html">Our Contract</a>
      - explains the rules with which your project should comply
     </li>
        
<li>
<a href="forrestbot-intro-old.html">Forrestbot introduction</a>
      - concise overview of Forrestbot
     </li>
      
</ul>
</div>
    
<a name="N10033"></a><a name="Using+the+Forrestbot"></a>
<h3>Using the Forrestbot</h3>
<div style="margin-left: 0 ; border: 2px">
<a name="N10039"></a><a name="Setting+up+the+centralized+service"></a>
<h4>Setting up the centralized service</h4>
<div style="margin-left: 0 ; border: 2px">
<p>The goal is to publish a static website that can be updated
          in near-real-time to accomodate newly available content. Forrestbot
          can run on one machine, get content from another machine, and publish
          to yet another machine.</p>
<p>Running the bot is as easy as calling the following in your shell.
          (executed in the root dir of the distribution.)</p>
<pre class="code">forrestbot -Dbot.config=myOwn.conf.xml -Dtemplate.echo=[true|false]</pre>
<p>It is quite typical to perform this from a shell script that gets
          scheduled for execution on a regular basis.</p>
</div>
<a name="N1004E"></a><a name="Describing+your+project+to+the+bot"></a>
<h4>Describing your project to the bot</h4>
<div style="margin-left: 0 ; border: 2px">
<div class="frame fixme">
<div class="label">Fixme (mpo)</div>
<div class="content">There is not yet a DTD for this configuration
          file.</div>
</div>
<p>The actions the bot is going to take are defined in the XML
          file pointed at with the <span class="codefrag">bot.config</span> System
          property. (if not specified with <span class="codefrag">-Dbot.config</span>
          then the default config from the
          distribution is taken: <span class="codefrag">./forrestbot.conf.xml</span>) </p>
<p>This configuration file has one (required, but optionally empty) child-element for
          setting cross-project defaults, followed by a list of
          project-elements that hold the configuration for the various projects
          that the bot is going to work on.</p>
<pre class="code">
&lt;?xml version="1.0"?&gt;
&lt;forrest-config&gt;
  &lt;defaults&gt;
     ...&lt;!-- different fallback values for various workstages --&gt;
  &lt;/defaults&gt;

  &lt;project name="project-name-1"&gt;
     ...&lt;!-- different subelements configure the various workstages --&gt;
  &lt;/project&gt;

  &lt;project name="project-name-2"&gt;
     ...&lt;!-- different subelements configure the various workstages --&gt;
  &lt;/project&gt;
&lt;/forrest-config&gt;

        </pre>
<p>During the bot-run, each project entry will start a parallel and
          independent process consisting of a number of so called 'workstages'.</p>
<p>These workstages are listed in the
          <span class="codefrag">./src/resources/forrestbot/stages.conf.xml</span> file and their actual
          execution is handled by the various template tasks in the
          <span class="codefrag">./resources/forrestbot/ant/templates.build.xml</span> file. </p>
<p>Currently the various workstages are:</p>
<ul>
          
<dl>
            
<dt>prepare</dt>
            
<dd> Make a clean Forrest-defined Cocoon context environment.</dd>
          
</dl>
          
<dl>
            
<dt>get-src</dt>
            
<dd>Slide in the project specific document sources in that Cocoon
            context environment.</dd>
          
</dl>
          
<dl>
            
<dt>generate</dt>
            
<dd> Actually generate the site using Cocoon</dd>
          
</dl>
          
<dl>
            
<dt>deploy</dt>
            
<dd>Publish the newly created site</dd>
          
</dl>
          
<dl>
            
<dt>cleanup</dt>
            
<dd>&lt;No real actions yet&gt;</dd>
          
</dl>
        
</ul>
<p>Inside the project element the configuration allows to set some
          parameters that get consumed in the template targets. This workstage dependant
          configuration always takes the following layout: an element with the name of
          one of the tasks, and an optional type-attribute with nested elements that hold
          parameter names, with required name attribute holding the actual parameter
          value. Example:</p>
<pre class="code">&lt;project name="xml-forrest"&gt;
    &lt;prepare&gt;
        &lt;skin name="forrest-site"/&gt;
    &lt;/prepare&gt;

    &lt;get-src type="cvs"&gt;
      &lt;host name="cvs.apache.org"/&gt;
      &lt;root name="/home/cvspublic"/&gt;
      &lt;user name="anoncvs"/&gt;
      &lt;passwd name="anoncvs"/&gt;
      &lt;module name="xml-forrest"/&gt;
      &lt;content-dir name="src/documentation"/&gt;
      &lt;project-dir name=""/&gt;
    &lt;/get-src&gt;

    &lt;generate&gt;
      &lt;debuglevel name="ERROR" /&gt;
    &lt;/generate&gt;  

    &lt;deploy type="scp"&gt;
      &lt;host name="krysalis.sourceforge.net"/&gt;
      &lt;root name="/home/groups/k/kr/krysalis/htdocs"/&gt;
      &lt;user name="forrestbot"/&gt;
      &lt;dir name="forrest"/&gt;
    &lt;/deploy&gt;
  &lt;/project&gt;</pre>
<div class="frame note">
<div class="label">Note</div>
<div class="content">Only the workstages that need configuration settings have an
          entry here. At all times there will be a workstage template called for each
          stage of the stages.conf.xml (even if it is not explicitly mentioned inside the
          &lt;project&gt; element.) </div>
</div>
<p>Explained in detail, this will</p>
<ul>
          
<li>SET names properties (workstage(.@type)?.*) to appropriate values
            (*/@name)</li>
          
<ul>
            
<dl>
              
<dt>prepare.skin</dt>
              
<dd>forrest-site</dd>
            
</dl>
            
<dl>
              
<dt>get-src.cvs.host</dt>
              
<dd>cvs.apache.org</dd>
            
</dl>
            
<dl>
              
<dt>get-src.cvs.root</dt>
              
<dd>/home/cvspublic</dd>
            
</dl>
            
<dl>
              
<dt>get-src.cvs.user</dt>
              
<dd>anoncvs</dd>
            
</dl>
            
<dl>
              
<dt>get-src.cvs.passwd</dt>
              
<dd>anoncvs</dd>
            
</dl>
            
<dl>
              
<dt>get-src.cvs.module</dt>
              
<dd>xml-forrest</dd>
            
</dl>
            
<dl>
              
<dt>get-src.cvs.content-dir</dt>
              
<dd>src/documentation</dd>
            
</dl>
<dl>
              
<dt>get-src.cvs.project-dir</dt>
              
<dd></dd>
            
</dl>
            
<dl>
              
<dt>generate.debuglevel</dt>
              
<dd>ERROR</dd>
            
</dl>
            
<dl>
              
<dt>deploy.scp.host</dt>
              
<dd>krysalis.sourceforge.net</dd>
            
</dl>
            
<dl>
              
<dt>deploy.scp.root</dt>
              
<dd>/home/groups/k/kr/krysalis/htdocs</dd>
            
</dl>
            
<dl>
              
<dt>deploy.scp.user</dt>
              
<dd>forrestbot</dd>
            
</dl>
            
<dl>
              
<dt>deploy.scp.dir</dt>
              
<dd>forrest</dd>
            
</dl>
          
</ul>
          
<li>and CALL the following templates
          (template.workstage(.@type)?):</li>
          
<ul>
            
<li>template.prepare</li>
            
<li>template.get-src.cvs</li>
            
<li>template.generate</li>
            
<li>template.deploy.scp</li>
            
<li>template.cleanup</li>
          
</ul>
        
</ul>
<p>What each of these templates is going to do with the parameters can
          be found in the templates.build.xml itself (at this stage) and is put out to
          the console if the bot is run with the <span class="codefrag">-Dtemplate.echo=true</span>
          flag</p>
<a name="N10150"></a><a name="Setting+bot-wide+defaults"></a>
<h5>Setting bot-wide defaults</h5>
<div style="margin-left: 0 ; border: 2px">
<p>The <span class="codefrag">&lt;defaults&gt;</span> section in the
            <span class="codefrag">&lt;forrest-config&gt;</span> allows for one-time setting of parameters
            you want to reuse for different projects. The syntax (and semantic value) of
            the nested elements is identical to the use inside the
            <span class="codefrag">&lt;project&gt;</span> tags.</p>
</div>
</div>
<div class="frame note">
<div class="label">Note</div>
<div class="content">Once you understand all of this you might decide NOT to run your
        own centralized service but rather ask your project to be taken up in the
        centralized service of the project team itself: just send a mail to
        forrest-dev <a href="mail-lists.html">mail list</a>
        defining the required parameters to be taken up in the
        process.</div>
</div>
<a name="N1016B"></a><a name="Checking+logs+and+getting+them+by+mail"></a>
<h4>Checking logs and getting them by mail</h4>
<div style="margin-left: 0 ; border: 2px">
<p>For each distinct project the Forrest bot is maintaining a separate
          working log of the different workstages being executed. These logs can be
          opened and viewed in the ./build/bot directory</p>
<p>In addition to the @name attribute the &lt;project&gt; tag also can
          contain a @sendlogto attribute that must be holding a (comma separated list
          off) email address(es) where the project specific log needs to be sent to after
          all workstages have been completed (or as soon as building failed)</p>
</div>
</div>
    
<a name="N10179"></a><a name="Current+supported+workstages+and+types."></a>
<h3>Current supported workstages and types.</h3>
<div style="margin-left: 0 ; border: 2px">
<a name="N1017F"></a><a name="%0A++++++++++"></a>
<h4>
          &lt;prepare&gt;
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>No specific type versions. (don't use type-attribute)</p>
<p>Template arguments:</p>
<ul>
          
<li>
<span class="codefrag">&lt;skin&gt;</span> @name holds the name of the skin to use.</li>
        
</ul>
</div>
<a name="N10197"></a><a name="%0A++++++++++-N10194"></a>
<h4>
          &lt;get-src ...&gt;
        </h4>
<div style="margin-left: 0 ; border: 2px">
<a name="N101A0"></a><a name="%0A++++++++++++"></a>
<h5>
            &lt;get-src type="cvs"&gt;
          </h5>
<div style="margin-left: 0 ; border: 2px">
<p>Template arguments:</p>
<ul>
            
<li>
<span class="codefrag">&lt;host&gt;</span> @name holds the ipaddress or dns name of the  cvs serving host</li>
            
<li>
<span class="codefrag">&lt;root&gt;</span> @name holds the cvs-root directory on that host</li>
            
<li>
<span class="codefrag">&lt;user&gt;</span> @name holds the username to use on the cvs repository </li>
            
<li>
<span class="codefrag">&lt;passwd&gt;</span> @name holds the password to use on the cvs repository</li>
            
<li>
<span class="codefrag">&lt;module&gt;</span> @name holds the module name that holds the </li>
            
<li>
<span class="codefrag">&lt;dir&gt;</span> @name holds the relative path to the {docroot} directory.  (This is the dir  that is holding the ./content/xdocs as specified in t. </li>
          
</ul>
</div>
<a name="N101CE"></a><a name="%0A++++++++++++-N101CB"></a>
<h5>
            &lt;get-src type="local-copy"&gt;
          </h5>
<div style="margin-left: 0 ; border: 2px">
<p>Template arguments:</p>
<ul>
            
<li>
<span class="codefrag">&lt;content-dir/&gt;</span> @name holds the path pointing to the {docroot} directory. (See the <a href="forrest-contract.html">contract</a> to understand what should be there.)</li>
            
<li>
<span class="codefrag">&lt;project-dir/&gt;</span> @name holds the path pointing to the {projecthome} directory where the xml project descriptors reside.</li>
          
</ul>
</div>
</div>
<a name="N101ED"></a><a name="%0A++++++++++-N101EA"></a>
<h4>
          &lt;generate&gt;
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>No specific type versions. (don't use type-attribute)</p>
<p>Template arguments:</p>
<ul>
          
<li>
<span class="codefrag">&lt;debuglevel&gt;</span> @name holds the threshold-level for showing debug statements in the cocoon generation process.</li>
        
</ul>
</div>
<a name="N10205"></a><a name="%0A++++++++++-N10202"></a>
<h4>
          &lt;deploy ...&gt;
        </h4>
<div style="margin-left: 0 ; border: 2px">
<a name="N1020E"></a><a name="%0A++++++++++++-N1020B"></a>
<h5>
            &lt;deploy type="scp"&gt;
          </h5>
<div style="margin-left: 0 ; border: 2px">
<p>Template arguments:</p>
<ul>
            
<li>
<span class="codefrag">&lt;host&gt;</span> @name holds the remote host where the file will be copied to.</li>
            
<li>
<span class="codefrag">&lt;user&gt;</span> @name holds the username to be used when logging onto the remote host.</li>
            
<li>
<span class="codefrag">&lt;root&gt;</span> @name holds the prefix part of where the content needs to be published.</li>
            
<li>
<span class="codefrag">&lt;dir&gt;</span> @name holds the suffix part of where the content needs to be published.</li>
          
</ul>
<div class="frame warning">
<div class="label">Warning</div>
<div class="content">Using this approach requires that the public key of the user executing the bot target is present in the authorized key file (<span class="codefrag">~/.ssh/authorized_keys2</span>) of the remote user (on the remote host).</div>
</div>
<div class="frame note">
<div class="label">Note</div>
<div class="content">Might be interesting to understand that the full process actually is bundling all files to copy in a *.tar.gz that is un-tar.gzipped on the remote host using ssh. </div>
</div>
</div>
<a name="N1023B"></a><a name="%0A++++++++++++-N10238"></a>
<h5>
            &lt;deploy type="local-copy"&gt;
          </h5>
<div style="margin-left: 0 ; border: 2px">
<p>Template arguments:</p>
<ul>
            
<li>
<span class="codefrag">&lt;destination&gt;</span> @name holds the path where the generated content needs to be copied to.</li>
          
</ul>
</div>
<a name="N10250"></a><a name="%0A++++++++++++-N1024D"></a>
<h5>
            &lt;deploy type="ftp"&gt;
          </h5>
<div style="margin-left: 0 ; border: 2px">
<p>Template arguments:</p>
<ul>
            
<li>
<span class="codefrag">&lt;host&gt;</span> @name holds the hostname of the ftp server to publish to.</li>
            
<li>
<span class="codefrag">&lt;user&gt;</span> @name holds the username to use for loging onto the ftp server.</li>
            
<li>
<span class="codefrag">&lt;passwd&gt;</span> @name holds the password to use.</li>
            
<li>
<span class="codefrag">&lt;destination&gt;</span> @name holds the path to the directory on the remote host where the generated content needs to be published.  The process is using the <span class="codefrag">ftp cd</span> command to get there.  This means this directory has to exist.</li>
          
</ul>
</div>
<div class="frame warning">
<div class="label">Warning</div>
<div class="content">Currently the ant distribution that is included in forrest cvs is not offering the required NetComponents.jar to actually support this type of deployment. If you want to use it anyway you should get the required jar from <a class="external" href="http://www.savarese.org/oro/downloads/index.html#NetComponents">http://www.savarese.org/oro/downloads</a> and drop that into your <span class="codefrag">{forrest-sandbox}/tools/antipede/lib</span> directory.  </div>
</div>
</div>
<a name="N10282"></a><a name="%0A++++++++++-N1027F"></a>
<h4>
          &lt;cleanup&gt;
        </h4>
<div style="margin-left: 0 ; border: 2px">
<p>No specific type versions. (don't use type-attribute)</p>
<p>Template arguments: None.</p>
</div>
</div>
    
<a name="N10293"></a><a name="ForrestBot+design"></a>
<h3>ForrestBot design</h3>
<div style="margin-left: 0 ; border: 2px">
<p>Most of us will just like things to work, and will be happy enough
        just using it, maybe even letting the forrest-dev
        <a href="mail-lists.html">mail list</a> know if we could improve
        this or the other. Some however might be drawn to the
      <a class="external" href="http://www.howstuffworks.com/">how stuff works</a> of things.
      For them is this section as a start in the rest of their own pursuit.</p>
<a name="N102A4"></a><a name="The+Ant+play"></a>
<h4>The Ant play</h4>
<div style="margin-left: 0 ; border: 2px">
<p>All actions and targets related to the actual execution of the bot's
          work is separated over 3 distinct build files:</p>
<ul>
          
<dl>
            
<dt>[main] <span class="codefrag">./build.xml</span>
</dt>
            
<dd>the starting point where generation and preparation is initiated.
            </dd>
          
</dl>
          
<dl>
            
<dt>[generated] <span class="codefrag">./build/bot/work.build.xml</span>
</dt>
            
<dd>the one that reflects the configured tasks in the
            forrestbot.conf.xml</dd>
          
</dl>
          
<dl>
            
<dt>[templates]
            <span class="codefrag">./src/resources/forrestbot/ant/templates.build.xml</span>
</dt>
            
<dd>listing the different targets that actually depict the supported
            workstages (and types of)</dd>
          
</dl>
        
</ul>
<p>The complete process runs as follows:</p>
<ol>
          
<li>'bot' target inside main build.xml depends on a number of targets
            that</li>
          
<ol>
            
<li>'bot.init': initialize the environment</li>
            
<li>'bot.conf2build': use XSLT stylesheets to convert the
            forrestbot.conf.xml into the work.build.xml (and a properties file for the
            default-section)</li>
            
<li>'bot.run': delegates to the 'work' target of the generated
            work.build.xml</li>
          
</ol>
          
<li>'work' target inside generated work.build.xml will then start in
          parallel (so failure of the one would not influence the other) the different
          project specific work-processes. </li>
          
<li>each of these project runs (generated 'work.[projectname]' targets)
          depends on the sequential execution of the different workstage actions
          (generated '[workstage].[projectname(.[type])?]' targets) </li>
          
<li>In those specific targets the pattern is as follows:</li>
          
<ol>
            
<li>set the project specific parameters for this project and
            workstage</li>
            
<li>load the default parameter values for the ones that aren't set
            yet</li>
            
<li>call the actual template.[workstage(.[type]?)]</li>
          
</ol>
        
</ol>
</div>
<a name="N102FC"></a><a name="Adding+features+to+the+bot+-+The+meta+template"></a>
<h4>Adding features to the bot - The meta template</h4>
<div style="margin-left: 0 ; border: 2px">
<p>Given the mechanism, the actual things the bot <strong>can</strong>
          do boil down to the template targets it can call. So extending the bot means:
          adding templates-targets.</p>
<p>If you want to add your own tempales to
          <span class="codefrag">template.build.xml</span>, take in account the following guidelines:</p>
<ul>
          
<li> in the future there will be a DTD for forrestbot.conf.xml that
            should be updated probably after you added stuff to the
            <span class="codefrag">templates.build.xml</span>. Backwards-incompatible changes need a formal
            vote.</li>
          
<li>build an echo target for each template target you make: </li>
        
</ul>
<pre class="code">

&lt;target name="echo.workstage-name.optional-type" if="template.echo"&gt;
    ... here you put echo ant-tasks that somewhat tell what you will
    ... do with all the params you expect
&lt;/target&gt;

&lt;target name="template.workstage-name.optional-type"
            depends="shared.set-props, echo.workstage-name.optional-type"&gt;
    ... here you put whatever ant-tasks that actually do it
&lt;/target&gt;          
    
        </pre>
</div>
</div>
  
<div class="attribution"></div>
</div>
</td><td width="10"><img width="10" height="1" alt="" src="skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1" bgcolor="#4C6C8F"><img height="1" width="1" alt="" src="skin/images/spacer.gif" class="spacer"><a href="skin/images/label.gif"></a><a href="skin/images/page.gif"></a><a href="skin/images/chapter.gif"></a><a href="skin/images/chapter_open.gif"></a><a href="skin/images/current.gif"></a></td>
</tr>
<tr>
<td colspan="2" bgcolor="#CFDCED" class="copyright" align="center"><font size="2" face="Arial, Helvetica, Sans-Serif"><a href="http://www.apache.org/licenses/LICENSE-2.0">
              Copyright &copy; 2002-2004&nbsp;
              The Apache Software Foundation.</a>
          All rights reserved.
          <script type="text/javascript" language="JavaScript"><!--
              document.write(" - "+"Last Published: " + document.lastModified);
            //  --></script></font></td>
</tr>
<tr>
<td colspan="2" align="left" bgcolor="#CFDCED" class="logos"></td>
</tr>
</table>
<!--================= end Footer ==================-->
</body>
</html>
