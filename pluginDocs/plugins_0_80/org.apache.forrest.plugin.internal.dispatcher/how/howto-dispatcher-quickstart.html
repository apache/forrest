<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
      <link href="../themes/common.css" media="screen" rel="alternate stylesheet" title="common" type="text/css" />
      <link href="../themes/leather-dev.css" media="screen" rel="alternate stylesheet" title="common" type="text/css" />
      <link href="../themes/pelt.screen.css" media="screen" rel="stylesheet" title="Pelt" type="text/css" />
      
      <link href="../how/howto-dispatcher-quickstart.dispatcher.css" media="screen" rel="stylesheet" title="Pelt" type="text/css" />
      <link href="../themes/pelt.print.css" media="print" rel="stylesheet" title="Pelt" type="text/css" />
      <style type="text/css">/* Extra css */ 
p.quote {
 margin-left: 2em; 
 padding: .5em; 
 background-color: #f0f0f0; 
 font-family: monospace; 
}</style>
    <meta content="Apache Forrest" name="Generator" />
<meta content="0.8" name="Forrest-version" />
<meta content="pelt" name="Forrest-theme-name" />
<meta content="text/html; charset=UTF-8" http-equiv="content-type" />
<!--+ |start navigation links +-->
<link href="../index.html" rel="Index" title="Index..." />
<link href="../linkmap.html" rel="CONTENTS" title="Site map..." />
<link href="../how/howto-dispatcher-structurer.html" rel="NEXT" title="Structurer" />
<link href="../how/configure-serializer.html" rel="LAST" title="Configure output serializer" />
<!--+ |end navigation links +-->
<!--+|start favicon +-->
<link href="../favicon.ico" rel="shortcut icon" />
<!--+|start favicon +-->
<script src="../themes/getBlank.js" type="text/javascript"> </script>
<script src="../themes/menu.js" type="text/javascript"> </script>
<script src="../themes/fontsize.js" type="text/javascript"> </script>
<!--+ |start content-title +-->
<title>Dispatcher quickstart</title>
<!--+ |end content-title +-->
</head>
<body>
<div id="container">
<!--+
    | start breadtrail
    +-->
<div class="breadtrail">
<a href="http://forrest.apache.org/">Apache Forrest</a>
<script src="../themes/breadcrumbs.js" type="text/javascript"> </script>
</div>
<!--+
    | end breadtrail
    +-->
<div id="header">
<div id="branding-tagline-name">new seed</div>
<div id="branding-tagline-tagline">powered by the
        dispatcher</div>
<div class="logo">
<!--+
    |start Logo
    +-->
<a href="http://forrest.apache.org/">
<img alt="Apache Forrest Logo" class="logoImage" src="../images/project-logo.gif" title="Apache Forrest" />
</a>
<!--+
    |end group Logo
    +-->
</div>
<div class="logo">
<!--+
    |start Logo
    +-->
<a href="http://forrest.apache.org/pluginDocs/">
<img alt="plugin logo" class="logoImage" src="../images/project.png" title="org.apache.forrest.plugin.internal.dispatcher plugin for Apache Forrest" />
</a>
<!--+
    |end group Logo
    +-->
</div>
<!--+
  |start Search
  +-->
<div class="searchbox">
<div class="round-top-left-small">
<div class="round-top-right-small">
<div class="search-input">
<form action="http://www.google.com/search" method="get">
<div class="search-hidden">
<input name="sitesearch" type="hidden" value="example.org" />
</div>
<div class="search-field">
<input name="q" onblur="getPrompt(this, 'Search the site with google');" onfocus="getBlank(this, 'Search the site with google');" size="25" type="text" value="Search the site with google" />
</div>
<div class="search-submit">
<input name="Search" type="submit" value="Search" />
</div>
</form>
</div>
</div>
</div>
</div>
<!--+ |end search +-->
<div id="nav-main-hook">
<!--+ |start Tabs new +-->
<ul id="nav-main">
<li>
<a class="base-not-selected" href="http://forrest.apache.org/pluginDocs">Forrest Plugins</a>
</li>
<li>
<a class="base-not-selected" href="../index.html">Home</a>
</li>
<li class="current">
<a class="base-selected" href="../how/howto-dispatcher-quickstart.html">HowTo</a>
</li>
<li>
<a class="base-not-selected" href="../int/index.html">Internals</a>
</li>
<li>
<a class="base-not-selected" href="../examples/index.html">Examples</a>
</li>
</ul>
<!--+ |end Tabs +-->
<div id="publishedStrip"> <!--+
    |start nav-main-sub
    +--><!--+
    |end Endtabs
    +--><script type="text/javascript">document.write("Last Published: " + document.lastModified);</script>
</div>
</div>
</div>
<div id="page">
<div id="leftbar">
<!--+ |start 0 menu +-->
<!--+ |start Menu +-->
<div id="nav-section">
<ul>
<li class="pagegroupselected" id="menu_selected_1.1Title">
<span onclick="SwitchMenu('menu_selected_1.1')">How to</span>
<ul class="selectedmenuitemgroup" id="menu_selected_1.1">
<li class="menupage">
<div class="menupagetitle">Quickstart</div>
</li>
<li class="menuitem">
<a href="../how/howto-dispatcher-structurer.html" title="">Structurer</a>
</li>
<li class="menuitem">
<a href="../how/howto-dispatcher-contracts.html" title="">Contracts</a>
</li>
<li class="menuitem">
<a href="../how/perFolderThemes/index.html" title="">Per Folder/File Themes</a>
</li>
<li class="menuitem">
<a href="../how/configure-serializer.html" title="">Configure output serializer</a>
</li>
</ul>
</li>
</ul>
</div>
<!--+ |end menu +-->
<!--+ |start content-motd-page +-->
<!--+ |end content-motd-page +-->
<div id="roundbottom">
<div id="roundbottomLeft">
<img alt="spacer" class="corner" src="../themes/images/spacer.gif" />
</div>
</div>
</div>
<div id="content">
<div id="export-link">
<a class="format" href="howto-dispatcher-quickstart.pdf">
<img alt="PDF - icon" class="skin" src="../themes/images/pdfdoc.gif" />
<span class="caption">PDF</span>
</a>
</div>
<div class="trail">
<script type="text/javascript">ndeSetTextSize();</script>
            Font size:
           <input class="resetfont" onclick="ndeSetTextSize('reset'); return false;" title="Reset text" type="button" value="Reset" />
           <input class="smallerfont" onclick="ndeSetTextSize('decr'); return false;" title="Shrink text" type="button" value="-a" />
           <input class="biggerfont" onclick="ndeSetTextSize('incr'); return false;" title="Enlarge text" type="button" value="+a" />
</div>
<!--+ |start content-title +-->
<h1 class="content-title">Dispatcher quickstart</h1>
<!--+ |end content-title +-->
<!--+ |start content-abstract +-->
<!--+ |end content-abstract +-->
<!--+ |start content-minitoc +-->
<div id="content-minitoc-area">
<ul class="minitoc">
<li>
<a href="#Intended Audience">Intended Audience</a>
</li>
<li>
<a href="#Purpose">Purpose</a>
</li>
<li>
<a href="#Prerequisites">Prerequisites</a>
</li>
<li>
<a href="#Steps">Steps</a>
<ul class="minitoc">
<li>
<a href="#patch">Get ready</a>
</li>
<li>
<a href="#enable">Dispatcher-enable the existing site</a>
</li>
<li>
<a href="#another-theme">Use another theme</a>
</li>
<li>
<a href="#our-structurer">Create our own structurer by copy-and-customise</a>
</li>
<li>
<a href="#remove-default-contract">Remove a default contract</a>
</li>
<li>
<a href="#add-default-contract">Add a default contract</a>
</li>
<li>
<a href="#add-project-contract">Add a new project contract</a>
</li>
<li>
<a href="#manage">Decide how to manage your contracts</a>
</li>
</ul>
</li>
<li>
<a href="#Further Reading">Further Reading</a>
</li>
<li>
<a href="#Feedback">Feedback</a>
</li>
</ul>
</div>
<!--+ |end minitoc +-->
<!--+ |start content-main +-->
<a name="Intended Audience" title="Intended Audience"> </a>
<h2 class="underlined_10">Intended Audience</h2>
<div class="section">
<p>
      People who are helping to develop the Dispatcher.
    </p>
<div class="warning">
<div class="label">Warning</div>
<div class="content">
      The "Dispatcher" (previously known as "Views") is new functionality which
      is still in development phase. That is why it is in the "whiteboard"
      section of Forrest. This document will also need to change to keep pace.
      We are working at the moment on moving this plugin from the whiteboard
      into the core plugins. See <a href="http://forrest.apache.org/docs/status-themes.html">Status of
      Themes: Skins and Dispatcher</a>.
    </div>
</div>
</div>
<a name="Purpose" title="Purpose"> </a>
<h2 class="underlined_10">Purpose</h2>
<div class="section">
<p>
      This document will get you started. We will Dispatcher-enable an existing
      site and show how to add/remove ready-made contacts. Then we will discuss
      how add your own new contracts.
    </p>
<p>
      This document encourages developers to get involved with fine-tuning and
      testing the dispatcher. Please help to enhance the current core contracts
      so that people do not need to re-invent the wheel.
    </p>
</div>
<a name="Prerequisites" title="Prerequisites"> </a>
<h2 class="underlined_10">Prerequisites</h2>
<div class="section">
<ul>
      <li>Using Forrest trunk of SVN (i.e. head of development).
      </li>
      <li>Followed the installation instructions below.</li>
      <li>You have an existing forrest site and want to try the
        new Dispatcher. Otherwise create a 'forrest seed-sample' site.</li>
    </ul>
</div>
<a name="Steps" title="Steps"> </a>
<h2 class="underlined_10">Steps</h2>
<div class="section">
<div class="note">
<div class="label">Note</div>
<div class="content">
      When developing with the dispatcher we assume you are using 'forrest run'
      and the following workflow "change files -&gt; refresh browser".
      <br />
      Installing a mozilla browser and the
      <a href="http://forrest.apache.org/tools/forrestbar.html">Forrestbar</a> helps a lot with developing, but
      is not necessary.
    </div>
</div>
<a name="patch" title="Get ready"> </a>
<h3 class="underlined_5">Get ready</h3>
<div class="section">
<ul>
        <li>Do 'svn update' on forrest/trunk</li>
        <li>Do the 'cd main; build clean; build' (necessary because the Dispatcher is changing rapidly and uses some Java)</li>
      </ul>
</div>
<a name="enable" title="Dispatcher-enable the existing site"> </a>
<h3 class="underlined_5">Dispatcher-enable the existing site</h3>
<div class="section">
<ul>
        <li>Add the new plugins to forrest.properties ...
        ,org.apache.forrest.plugin.internal.dispatcher,org.apache.forrest.themes.core
        </li>
        <li>localhost:8888/index.html ... fantastic. See the pelt view.</li>
      </ul>
</div>
<a name="another-theme" title="Use another theme"> </a>
<h3 class="underlined_5">Use another theme</h3>
<div class="section">
<ul>
        <li>Add &lt;property name="dispatcher.theme" value="pelt"/&gt; 
          to your forrest.properties.xml</li>
        <li>Re-start 'forrest run'</li>
        <li>localhost:8888/index.html ... See the new view.</li>
      </ul>
</div>
<a name="our-structurer" title="Create our own structurer by copy-and-customise"> </a>
<h3 class="underlined_5">Create our own structurer by copy-and-customise</h3>
<div class="section">
<p>
        Copy the default structurer for the pelt theme and make local changes.
      </p>
<div class="note">
<div class="label">Note</div>
<div class="content">
        At this stage of rapid development of the Dispatcher, be sure to keep
        your copy synchronised. Use 'diff' against the known svn version of the
        core pelt.fv to track your local changes. Also please consider
        contributing new contracts and changes to the default structurers to the
        Forrest projects. That eases your local version management and everyone
        will benefit.
      </div>
</div>
<div class="note">
<div class="label">Note</div>
<div class="content">
        We use <span class="codefrag">${themer.project.dir}</span> for
        PROJECT_HOME/src/documentation/resources/themes (create the new
        directory first). You can change this location by adding
&lt;match pattern="themer.project.dir"&gt;
          &lt;location src="{properties:resources}/themes" /&gt;
        &lt;/match&gt; 
        to your locationmap and point to another directory.
      </div>
</div>
<div class="note">
<div class="label">Note</div>
<div class="content">
      By default THEMER_PLUGIN can be located at FORREST_HOME/whiteboard/plugins/org.apache.forrest.themes.core
      </div>
</div>
<ul>
        <li>Copy THEMER_PLUGIN/themes/pelt.fv into your project at
          ${themer.project.dir}/pelt.fv
        </li>
        <li>Copy THEMER_PLUGIN/themes/pelt/panels/pelt-html.header.panel.xml into your
          project at ${themer.project.dir}/pelt/panels/pelt-html.header.panel.xml
        </li>
        <li>Re-start 'forrest run'</li>
        <li>localhost:8888/index.html ... See the same view, now structured
          by us.
        </li>
        <li>In localhost:8888/resolve.structurer.index you can find a copy of your current structurer. Any change  made to your pelt.fv file will be added here.
        </li>
      </ul>
<p>
        From here on there is no need to re-start 'forrest run'. Just edit the
        structurer and see the effect.
      </p>
<div class="warning">
<div class="label">Warning</div>
<div class="content">
      Right now the dispatcher is heavely cached, so maybe in the current version it should be
      necessary to reboot the system in order to see the changes. To avoid temporally this problem,
      turn off the cache system changing:
      

&lt;forrest:views xmlns:forrest="http://apache.org/forrest/templates/1.0"
	xmlns:jx="http://apache.org/cocoon/templates/jx/1.0"
	jx:cache-key="#{$cocoon/parameters/getRequest}"
	jx:cache-validity="${Packages.org.apache.excalibur.source.impl.validity.NOPValidity()}"&gt;

      
      to
      

&lt;forrest:views xmlns:forrest="http://apache.org/forrest/templates/1.0"
	xmlns:jx="http://apache.org/cocoon/templates/jx/1.0"&gt;

      
      in your THEMER_PLUGIN/themes/pelt.fv file.
      </div>
</div>
</div>
<a name="remove-default-contract" title="Remove a default contract"> </a>
<h3 class="underlined_5">Remove a default contract</h3>
<div class="section">
<ul>
        <li>Remove the top breadcrumb trail. Edit your pelt-html.header.panel.xml, find the
          "branding-breadcrumbs" contract and comment it out.
        </li>
      </ul>
</div>
<a name="add-default-contract" title="Add a default contract"> </a>
<h3 class="underlined_5">Add a default contract</h3>
<div class="section">
<p>
        Forrest provides many default contracts. If you are using the Forrestbar
        then choose "dispatcher-devs =&gt; ls.contracts". Otherwise visit
        localhost:8888/ls.contracts.html
      </p>
<ul>
        <li>
          See the usage detail for your chosen contract via the above mentioned list.
          e.g. "siteinfo-current-time"
        </li>
        <li>
          Insert it at the appropriate point in your structurer. Note that it
          will need to go inside the appropriate CSS hook, e.g.
        <pre class="code">
  ...
  &lt;forrest:hook name="footer"&gt;
    &lt;forrest:contract name="siteinfo-current-time"/&gt;
    ...

          </pre>
</li>
      </ul>
<p>
        Notice that you did not need to copy any other code to your project
        space. Forrest finds the default contract in its core (the themes.core
        plugin).
      </p>
<p>
        You will find some commonly used contracts in place but commented out in
        both the common and the pelt structurer files. Feel free to uncomment
        them to activate them, move them around into other hooks or create new
        hooks for them.
      </p>
<div class="note">
<div class="label">Note</div>
<div class="content">
        Work is currently under way for implementing Panels (was tiles).
        Currently we now have a 'panels' sub-dir for each 'theme'. This panels
        sub-dir currently contains a main html panel
        '%themename%-html.panel.xml' and a CSS panel
        '%themename%-css.panel.xml'. So you can change a collection of HTML and
        CSS outputs from these two XML files.
      </div>
</div>
</div>
<a name="add-project-contract" title="Add a new project contract"> </a>
<h3 class="underlined_5">Add a new project contract</h3>
<div class="section">
<div class="warning">
<div class="label">Warning</div>
<div class="content">
        Carefully consider the purpose of your contracts. If they are useful in
        a wider context, then they belong in plugins or the core of Forrest. See
        below for further discussion on this important topic.
      </div>
</div>
<p>
        Project-based contracts are defined in theme-specific and
        output-format-specific directory structure, e.g.
        ${themer.project.dir}/THEME_NAME/OUTPUT_FORMAT/
      </p>
<p>
        Project-based contracts common to all themes go in
        ${themer.project.dir}/common/OUTPUT_FORMAT/
      </p>
<p>
        To get started quickly (it is not a project-based contract but a demo),
        copy one of the default contracts. e.g. copy siteinfo-current-time.ft to
        become siteinfo-doodad.ft ...
      </p>
<ul>
        <li>
          Copy THEMER_PLUGIN/themes/common/html/siteinfo-current-time.ft
          into your project at
          ${themer.project.dir}/common/html/siteinfo-doodad.ft
          (create the new directory first).
        </li>
        <li>
          Edit it to suit. Replace all occurrences of "siteinfo-current-time" with
          "siteinfo-doodad" and make your other changes (e.g. the text and the
          javascript function).
        </li>
        <li>
          Declare your new contract in your structurer as done above for adding a
          default contract.
        </li>
      </ul>
<p>
        See a list of your project-based contracts and their usage notes via
        Forrestbar "dispatcher-devs =&gt; ls.contracts.project". Otherwise visit
        localhost:8888/ls.contracts.project.html
      </p>
</div>
<a name="manage" title="Decide how to manage your contracts"> </a>
<h3 class="underlined_5">Decide how to manage your contracts</h3>
<div class="section">
<p>
      Depending on the use of a new contract you can place it in different 
      locations. General use contracts should be placed in the THEME_PLUGIN 
      directory. Contracts only suitable for one theme should be stored in 
      the specific theme directory, that is, 
      <span class="codefrag">THEMER_PLUGIN/resources/themes/THEME_NAME/OUTPUT_FORMAT</span>. 
      Otherwise, common contracts should be place in the common folder: 
      <span class="codefrag">THEMER_PLUGIN/resources/themes/common/OUTPUT_FORMAT</span>.
      </p>
<p>
      If the contract is specific to a particular purpose, that is a 
      particular plugin, it should be included with the plugin itself. 
      For example, the "employment history" contract is specific to the 
      resume plugin so it should be placed there. The correct location for 
      contrats with a particular purpose is 
      <span class="codefrag">PLUGIN_NAME/resources/themes/THEME_NAME/OUTPUT_FORMAT</span>.
      </p>
<p>
      There is another category for contracts, those that are both specific 
      to a particular purpose and defined for a specific site. For example, 
      a "process order" contract that integrates with an in-house order 
      management system. In this case, another location is more suitable. 
      However, before proceed think again about the uniqueness of the contract.
      Most contracts can be generalised to be useful in more than one 
      environment and so one of the above locations can be used. If you are 
      still sure that this is a site-specific contract then place it in 
      <span class="codefrag">PROJECT_HOME/src/documentation/resources/themes/common</span>.
      </p>
<p>
      If you develop a new contract, please provide a patch via our 
      <a href="http://forrest.apache.org/issues.html">issue tracker</a> so that we 
      can include it in future releases of Forrest.
      </p>
</div>
</div>
<a name="Further Reading" title="Further Reading"> </a>
<h2 class="underlined_10">Further Reading</h2>
<div class="section">
<p>
      Congratulations you are now able to work with the Dispatcher. From here we
      recommend to read the following How-Tos:
    </p>
<ul>
      <li>
<a href="../how/howto-dispatcher-structurer.html">How to use the structurer</a>
</li>
      <li>
<a href="../how/howto-dispatcher-contracts.html">Create your own contract 
          implementation</a>
</li>
    </ul>
</div>
<a name="Feedback" title="Feedback"> </a>
<h2 class="underlined_10">Feedback</h2>
<div class="section">
<p>
      Please provide feedback about this document via the
      <a href="http://forrest.apache.org/mail-lists.html">mailing lists</a>.
    </p>
</div>
<!--+ |end content-main +-->
</div>
</div>
<div id="footer">
<div class="lastmodified">
<script type="text/javascript">document.write("Last Published: " + document.lastModified);</script>
</div>
<div class="copyright">
            Copyright ©
             2002-2009 <a href="http://example.org">The Example Organisation.</a> </div>
<!--+ |start compliance links +-->
<div id="siteinfo-compliance-links">
<a href="http://validator.w3.org/check?uri=referer">
<img alt="Valid XHTML 1.0!" height="31" src="http://www.w3.org/Icons/valid-xhtml10" width="88" />
</a>
<a href="http://jigsaw.w3.org/css-validator/check/referer">
<img alt="Valid CSS!" src="http://jigsaw.w3.org/css-validator/images/vcss" style="border:0;width:88px;height:31px" />
</a>
</div>
<!--+ |end compliance links +-->
</div>
</div>
</body>
</html>
