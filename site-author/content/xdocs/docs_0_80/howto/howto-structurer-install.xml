<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 2002-2005 The Apache Software Foundation or its licensors,
  as applicable.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE howto PUBLIC "-//APACHE//DTD How-to V2.0//EN" "http://forrest.apache.org/dtd/howto-v20.dtd">

<howto>
 <header>
  <title>How to install the "dispatcher"</title>
  <abstract>
    This How-To describes the setup of the plugins (needed to work with forrest:views and forrest:contracts) and a fresh v2 seed site.
  </abstract>
  <last-modified-content-date date="2005-10-04"/>
 </header>

  <audience title="Intended Audience">

<warning>
The "Dispatcher" (aka "Views") is new functionality which is still in development phase. That is why it is in the
"whiteboard" section of the Forrest distribution. This HowTo is a good start but still needs more work.
</warning>
    <p>
      Developers who want to get started with "dispatcher" development and want to help testing and developing the "dispatcher".
    </p>
  </audience>
  
  <purpose title="Purpose">
    <p>
      Quick guide installing the "dispatcher". This is the "getting started" setup guide.
    </p>
  </purpose>

  <prerequisites title="Prerequisites">
    <ul>
      <li>Need the SVN trunk version of Forrest for using the "dispatcher" because it is in an early stage.</li>
      <li>Read <a href="site:v0.80//howto/buildPlugin">How to Build a Plugin</a>
        especially the section about using Forrest's own Ant.</li>
      <li>Installing a mozilla browser and the
        <a href="site:tools/forrestbar">Forrestbar</a> helps a lot in developing.</li>
    </ul>
  </prerequisites>

  <steps title="Steps">
    <p>
      The process of setting up the plugin should be easy. Still it has too many stages and it
       will become easier in the future.
    </p>
    <section id="localBuild">
      <title>Build the internal.structurer and the output.themer plugins</title>
      <p>
        The first step is to build and deploy the internal.structurer and the output.themer plugins.
      </p>
      <p>
        Run the script <code>etc/structurer.sh</code> *after* you did an svn update.
      </p>
      <p>
        Otherwise build and deploy them manually. Do your usual 'svn update', then ...
      </p>

       <source>
cd whiteboard/plugins/org.apache.forrest.plugin.internal.structurer/
$FORREST_HOME/tools/ant/bin/ant local-deploy
cd ../org.apache.forrest.plugin.output.themer/
$FORREST_HOME/tools/ant/bin/ant local-deploy
      </source>
    </section>
    <section id="newSeed">
      <title>Seed a new project</title>
      <p> Go to the directory where you want to seed a new project and seed it ...
      </p>
      <source>cd ~/src/ 
mkdir v2 
cd v2/ 
forrest seed-v2 </source>
     <note>
       For the moment we will use a special seed template called seed-v2. We still 
        need to fix issues of the dispatcher, so that it really can replace old 
        fashion skins. Like performance, standalone contracts, other testing output/input formats - using POJO based 
        processing will help solving this.  All this will ATM happen in the v2 seed-target till the dispatcher will 
        be released to the stable plugins. So make regular updates of your forrest-trunk to keep track.
     </note>
     <warning>
      The way we develop contracts will/may change with introduction of java-based processing 
      (for certain parts) rather then xsl. Please keep this in mind
        and help updating the documentation by sending patches. TIA. ;-)
     </warning>
    </section>
    <section id="forrestProperties">
      <title>Modify forrest.properties</title>
      <p>
        Make sure to tell forrest to use the dispatcher plugins. Of course, if you are
        using "seed-v2" then this is already done. If you are converting an existing site to use 
        dispatcher, then do this.
      </p>
      <p>
        Edit forrest.properties to add the required plugins:
      </p>
      <source>
project.required.plugins=org.apache.forrest.plugin.output.themer,org.apache.forrest.plugin.internal.structurer
      </source>
    </section>
    <section id="testing">
      <title>Test your new "dispatcher" based project</title>
      <p> 
        Now you have finished the preparation and the setup to finally do
        <code>'forrest run'</code> and
        point your browser to <code>http://localhost:8888/</code> and you will see the default
        dispatcher-based site. Use your browser's menu option "View -&gt; Page Style" to switch
        themes.
      </p>
    </section>
    <section id="availableContracts">
      <title>Available contracts</title>
      <p> 
       To start working with the dispatcher, you need to know which contracts you can use. 
       If you used the seed-v2 then the Samples tab will lead to 
       the available contracts.</p>
      <p>
       Forrestbar is another way to see available contracts. See the menu point "Devs"
       (ls.contracts and/or ls.contracts.project)
      </p><p>
        Now point your browser to e.g. <code>http://localhost:8888/ls.contracts.html</code> 
        ... On this page you will find all contracts that you can use in your project.
      </p>
    </section>
  </steps>
  <extension title="Further Reading">
    <p>
      Congratulations you are now able to work with the dispatcher. 
      From here we recommend to read the following How-To's (in this order):
    </p>
    <ul>
      <li><a href="site:v0.80//howto/dispatcher/structurer">Getting started with the "structurer"</a> </li>
      <li><a href="site:v0.80//howto/dispatcher/contracts">Create your own contract implementation</a> </li>
    </ul>
  </extension>
  <feedback title="Feedback">
    <p>
      Please provide feedback about this document via the "dev"
      <a href="site:mail-lists">mailing list</a>.
    </p>
  </feedback>
</howto>
