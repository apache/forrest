<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.7-dev">
<meta name="Forrest-skin-name" content="pelt">
<title>Extending Forrest with Plugins</title>
<link type="text/css" href="../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../skin/print.css" rel="stylesheet">
<link type="text/css" href="../skin/profile.css" rel="stylesheet">
<script src="../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../favicon.ico">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">apache</a> &gt; <a href="http://forrest.apache.org/">forrest</a><script src="../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://www.apache.org/"><img class="logoImage" alt="Apache" src="../images/apache-forrest.png" title="The Apache Software Foundation"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://forrest.apache.org/"><img class="logoImage" alt="Forrest" src="../images/project-logo.gif" title="Apache Forrest"></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="forrest.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google:');" value="Search the site with google:" size="25" name="q" id="query" type="text">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="base-not-selected" href="../index.html">Welcome</a>
</li>
<li>
<a class="base-not-selected" href="../contrib.html">Project</a>
</li>
<li class="current">
<a class="base-selected" href="../docs/your-project.html">Documentation</a>
</li>
<li>
<a class="base-not-selected" href="../howto/index.html">How-To</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs">
<a class="base-selected" href="../docs/your-project.html">Core</a> | <a class="base-selected" href="../docs/forrestbot.html">ForrestBot</a> | <a class="base-selected" href="../docs/forrestbar.html">ForrestBar</a>
</div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript" language="JavaScript"><!--
              document.write("Published: " + document.lastModified);
              //  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
             
             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', '../skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('../skin/images/chapter_open.gif');">Documentation</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a title="" href="../docs/your-project.html">Using Forrest</a>
</div>
<div class="menuitem">
<a title="" href="../docs/validation.html">XML Validation</a>
</div>
<div class="menuitem">
<a title="" href="../docs/linking.html">Menus and Linking</a>
</div>
<div class="menuitem">
<a title="" href="../docs/searching.html">Searching</a>
</div>
<div class="menuitem">
<a title="" href="../docs/skins.html">Default Skins</a>
</div>
<div class="menuitem">
<a title="" href="../docs/skin-package.html">Skin Packages</a>
</div>
<div class="menupage">
<div class="menupagetitle">Plugins</div>
</div>
<div class="menuitem">
<a title="" href="../docs/forrest-contract.html">Our Contract</a>
</div>
<div class="menuitem">
<a title="" href="../docs/compliance.html">Standards Compliance</a>
</div>
<div onclick="SwitchMenu('menu_1.1.10', '../skin/')" id="menu_1.1.10Title" class="menutitle">Advanced Topics</div>
<div id="menu_1.1.10" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/catalog.html">Using DTD Catalogs</a>
</div>
<div class="menuitem">
<a title="" href="../docs/sitemap-ref.html">Sitemap Reference</a>
</div>
<div class="menuitem">
<a title="" href="../docs/project-sitemap.html">Project sitemap</a>
</div>
<div class="menuitem">
<a title="" href="../docs/cap.html">Sourcetype Action</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.11', '../skin/')" id="menu_1.1.11Title" class="menutitle">Upgrading</div>
<div id="menu_1.1.11" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/upgrading_06.html">Upgrading to 0.6</a>
</div>
<div class="menuitem">
<a title="" href="../docs/upgrading_05.html">Upgrading to 0.5</a>
</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.2', '../skin/')" id="menu_1.2Title" class="menutitle">SubProjects</div>
<div id="menu_1.2" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/forrestbar.html">ForrestBar</a>
</div>
<div class="menuitem">
<a title="" href="../docs/forrestbot.html">Forrestbot</a>
</div>
<div class="menuitem">
<a title="" href="../docs/forrestbot-web-interface.html">Forrestbot Webapp</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3', '../skin/')" id="menu_1.3Title" class="menutitle">Reference docs</div>
<div id="menu_1.3" class="menuitemgroup">
<div onclick="SwitchMenu('menu_1.3.1', '../skin/')" id="menu_1.3.1Title" class="menutitle">DTD documentation</div>
<div id="menu_1.3.1" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/dtd-docs.html">Overview</a>
</div>
<div class="menuitem">
<a title="" href="../docs/document-v20.dtdx.html">document-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/howto-v20.dtdx.html">howto-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/faq-v20.dtdx.html">faq-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/document-v13.dtdx.html">document-v13</a>
</div>
<div class="menuitem">
<a title="" href="../docs/howto-v13.dtdx.html">howto-v13</a>
</div>
<div class="menuitem">
<a title="" href="../docs/faq-v13.dtdx.html">faq-v13</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3.2', '../skin/')" id="menu_1.3.2Title" class="menutitle">Doc samples</div>
<div id="menu_1.3.2" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/document-v13.html">document-v13</a>
</div>
<div class="menuitem">
<a title="" href="../docs/document-v20.html">document-v20</a>
</div>
<div class="menuitem">
<a title="" href="../docs/wiki-sample.html">JSPWiki Reference</a>
</div>
<div class="menuitem">
<a title="" href="../docs/oowriter.html">OpenOffice.org Writer</a>
</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.4', '../skin/')" id="menu_1.4Title" class="menutitle">Older Docs</div>
<div id="menu_1.4" class="menuitemgroup">
<div class="menuitem">
<a title="" href="../docs/primer.html">Forrest Primer</a>
</div>
<div class="menuitem">
<a title="" href="../docs/libre-intro.html">Libre</a>
</div>
<div class="menuitem">
<a title="" href="../docs/dreams.html">Dream list</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div id="skinconf-txtlink"></div>
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="plugins.pdf"><img alt="PDF -icon" src="../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<div class="trail">
	        Font size: 
	          &nbsp;<input value="Reset" class="resetfont" title="Reset text" onclick="ndeSetTextSize('reset'); return false;" type="button">      
	          &nbsp;<input value="-a" class="smallerfont" title="Shrink text" onclick="ndeSetTextSize('decr'); return false;" type="button">
	          &nbsp;<input value="+a" class="biggerfont" title="Enlarge text" onclick="ndeSetTextSize('incr'); return false;" type="button">
</div>
<h1>Extending Forrest with Plugins</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#overview">Overview</a>
<ul class="minitoc">
<li>
<a href="#What+plugins+are+available%3F">What plugins are available?</a>
</li>
<li>
<a href="#How+is+a+Plugin+Installed%3F">How is a Plugin Installed?</a>
</li>
</ul>
</li>
<li>
<a href="#What+is+a+Forrest+Plugin%3F">What is a Forrest Plugin?</a>
<ul class="minitoc">
<li>
<a href="#An+Example+Plugin">An Example Plugin</a>
</li>
</ul>
</li>
<li>
<a href="#What+Does+a+Forrest+Plugin+Look+Like%3F">What Does a Forrest Plugin Look Like?</a>
<ul class="minitoc">
<li>
<a href="#The+IMS+Manifest+Plugin">The IMS Manifest Plugin</a>
</li>
</ul>
</li>
<li>
<a href="#How+does+Installation+work%3F">How does Installation work?</a>
</li>
</ul>
</div>
    
<a name="N1000D"></a><a name="overview"></a>
<h2 class="underlined_10">Overview</h2>
<div class="section">
<p>Forrest provides the core functionality for generating documentation
      in various output formats from a range of input formats. However, it
      does not end there. Forrest can be extended through the addition of
      plugins. This document serves as an introduction to the Forrest
      plugin mechanism.</p>
<a name="N10016"></a><a name="What+plugins+are+available%3F"></a>
<h3 class="underlined_5">What plugins are available?</h3>
<p>You can run the command <span class="codefrag">forrest available-plugins</span> to get
        a list of the known plugins for Forrest.</p>
<p>If you would like to have your own plugin added to this list then
        contact the <a href="../mail-lists.html">developer mailing list</a>.</p>
<a name="N1002A"></a><a name="How+is+a+Plugin+Installed%3F"></a>
<h3 class="underlined_5">How is a Plugin Installed?</h3>
<p>If a site requires a plugin then it will be named in the 
        <span class="codefrag">project.required.plugins</span> property in the projects
        <span class="codefrag">forrest.properties</span> file. When Forrest builds the site
        it will automatically discover the plugin and install it. In otherwords,
        the user need do nothing.</p>
</div>
    
    
<a name="N1003B"></a><a name="What+is+a+Forrest+Plugin%3F"></a>
<h2 class="underlined_10">What is a Forrest Plugin?</h2>
<div class="section">
<p>A Forrest plugin is a set of resources and configuration files that 
      extend the functionality of Forrest. They will typically consist of a 
      sitemap, zero or more stylesheets and zero or more schema's.</p>
<p>The plugins sitemap is mounted by Forrest's sitemap after the project 
      specific sitemap but before the Forrest default matchers. This allows 
      individual projects to override/extend functionality provided in either 
      a plugin or Forrest whilst plugins are only able to override/extend the 
      default Forrest behaviour.</p>
<p>Forrest is easily extensible through the existing sitemap.xmap files, 
      however the more features we add, the more complex the sitemap becomes. It 
      is already quite difficult to understand the default sitemap.xmap files, 
      and this will only get worse as new features find their way into the 
      core.</p>
<p>By adopting a plugin model we can keep the core of Forrest tightly 
      focused on the basic functionality, whilst still facilitating extensions 
      to suit individual projects needs.</p>
<a name="N1004D"></a><a name="An+Example+Plugin"></a>
<h3 class="underlined_5">An Example Plugin</h3>
<p>In order to fully understand the applicability of Forrest Plugins we 
        will consider an extension to the way in which Forrest defines the 
        structure of the site. By default Forrest uses a site.xml file to 
        define navigation through the site and a tabs.xml file to define the 
        tabs across the top of the page. But what if we want to use a different
        file to describe site structure? For example, what if we want to use an
        IMS Manifest file from the SCORM content package standards 
        (http://www.adlnet.org/).</p>
<p>An IMS Manifest file describes the structure of a site. It is also 
        possible to define a set of rules for extracting tab information from 
        such a file. Consequently, it is possible to use an IMSManifest file to 
        create Forrest's site.xml and tabs.xml files. The advantage would be that
        we can then use SCORM compliant content objects within Forrest.</p>
<p>Unfortunately, IMS Manifests are much more complex than site.xml and 
        tabs.xml files. Therefore, not all users will want to use them. Adding 
        the functionality as an optional plugin seems to be the ideal 
        solution.</p>
</div>

    
<a name="N1005E"></a><a name="What+Does+a+Forrest+Plugin+Look+Like%3F"></a>
<h2 class="underlined_10">What Does a Forrest Plugin Look Like?</h2>
<div class="section">
<p>Plugins will need to conform to a specified directory structure. 
      This mirrors the default forrest directory structure:</p>
<pre class="code">
[plugin_name]
  |
  |-- config files (xmap, skinconf etc.)
  |
  |-- resources
      |
      |-- schema
      |   |
      |   |-- catalog.xcat
      |   |
      |   |--DTD (dtd's etc.)
      |
      |-- stylesheets (xsl's etc.)
</pre>
<a name="N1006B"></a><a name="The+IMS+Manifest+Plugin"></a>
<h3 class="underlined_5">The IMS Manifest Plugin</h3>
<p>If we consider the IMS Manifest Plugin described above we see that we
      will need the following files and directory structure:</p>
<pre class="code">
IMSManifest
  |
  |-- sitemap.xmap
  |
  |-- resources
      |
      |-- stylesheets
                    |
                    |- imsmanifest2site.xsl
                    |- imsmanifest2tabs.xsl
                    |- pathutils.xsl
                    |- repositoryUtils.xsl
</pre>
<p>The sitemap.xmap file will override the default behaviour for the 
      navigation generation matchers in Forrest, for example, it contains 
      a matcher as follows:</p>
<pre class="code">
&lt;map:match pattern="abs-menulinks"&gt;
  &lt;map:select type="exists"&gt;
    &lt;map:when test="{project:content.xdocs}imsmanifest.xml"&gt;
       &lt;map:generate src="{project:content.xdocs}imsmanifest.xml" /&gt;
       &lt;map:transform src="{forrest:plugins}/IMSManifest/resources/stylesheets/imsmanifest2site.xsl"/&gt;
       &lt;map:transform src="{forrest:stylesheets}/absolutize-linkmap.xsl" /&gt;
       &lt;map:transform src="{forrest:stylesheets}/site2site-normalizetabs.xsl" /&gt;
     &lt;map:serialize type="xml"/&gt;
   &lt;/map:when&gt;
   &lt;map:when test="{project:content.xdocs}site.xml"&gt;
      &lt;map:generate src="{project:content.xdocs}site.xml" /&gt;
      &lt;map:transform src="{forrest:stylesheets}/absolutize-linkmap.xsl" /&gt;
      &lt;map:transform src="{forrest:stylesheets}/site2site-normalizetabs.xsl" /&gt;
      &lt;map:transform src="{forrest:stylesheets}/normalizehrefs.xsl"/&gt;
    &lt;map:serialize type="xml"/&gt;
  &lt;/map:when&gt;
  &lt;/map:select&gt;
&lt;/map:match&gt;
</pre>
<div class="frame note">
<div class="label">Note</div>
<div class="content">Note that this matcher will default to the behaviour provided by 
      Forrest if there is no imsmanifest.xml file present in the project.
      At present it is necessary to copy this default behaviour from the original
      Forrest *.xmap files. We hope to improve on this in the future.</div>
</div>
</div>

  
<a name="N10084"></a><a name="How+does+Installation+work%3F"></a>
<h2 class="underlined_10">How does Installation work?</h2>
<div class="section">
<p>When Forrest installs a plugin it downloads a zip of the plugin code and 
    extracts it into the <span class="codefrag">plugins</span> directory of Forrest and an entry is made 
    in <span class="codefrag">src/plugins/sitemap.xmap</span>. For example, installing the 
    IMSManifest plugin described above will result in the following entry 
    being added to the plugin sitemap:</p>
<pre class="code">
&lt;map:select type="exists"&gt;
  &lt;map:when test="{forrest:plugins}/IMSManifest/sitemap.xmap"&gt;
    &lt;map:mount uri-prefix="" 
      src="{forrest:plugins}/IMSManifest/sitemap.xmap" 
      check-reload="yes" 
      pass-through="true"/&gt;
  &lt;/map:when&gt;
&lt;/map:select&gt;
  </pre>
<p>Installed plugins are managed by the
      FORREST_INSTALL_DIR/plugins/sitemap.xmap file. This file is mounted
      by the main Forrest sitemap with the following code:</p>
<pre class="code">
        &lt;map:pipeline internal-only="false"&gt;
           &lt;map:mount uri-prefix=""
                      src="{forrest:plugins}/sitemap.xmap"
                      check-reload="yes"
                      pass-through="true"/&gt;
        &lt;/map:pipeline&gt;
  </pre>
<div class="frame note">
<div class="label">Note</div>
<div class="content">The plugin sitemap.xmap file is automatically managed by Forrest, the 
      end user need never edit this file.</div>
</div>
</div>
  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
 Copyright &copy; 2002-2004 The Apache Software Foundation.</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
