<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Menus and Linking</title>
<link type="text/css" href="../skin/page.css" rel="stylesheet">
<link rel="shortcut icon" href="../favicon.ico">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Navigation Path ==================-->
<table summary="navigation path" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td nowrap="nowrap" valign="middle" bgcolor="#CFDCED" height="20"><img height="1" width="5" alt="" src="../skin/images/spacer.gif" class="spacer"><!--===== breadcrumb trail (javascript-generated) ====--><font size="2" face="Arial, Helvetica, Sans-serif"><a href="http://www.apache.org/">apache</a> &gt; <a href="http://forrest.apache.org/">forrest</a><script src="../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script></font></td>
</tr>
<tr>
<td bgcolor="#4C6C8F" height="2"><img height="2" width="2" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
<!--================= end Navigation Path ==================-->
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td bgcolor="#294563"><a href="http://www.apache.org/"><img class="logoImage" alt="Apache" src="../images/apache-forrest.png" title="The Apache Software Foundation"></a></td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" align="center" bgcolor="#294563"><a href="http://forrest.apache.org/"><img class="logoImage" alt="Forrest" src="../images/project-logo.gif" title="Apache Forrest"></a></td>
<!--================= end Project Logo ==================-->
<!--================= start Search ==================--><td valign="top" rowspan="2" bgcolor="#294563">
<form target="_blank" action="http://www.google.com/search" method="get">
<table summary="search" border="0" cellspacing="0" cellpadding="0" bgcolor="#4C6C8F">
<tr>
<td colspan="3"><img height="10" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap"><input value="forrest.apache.org" name="as_sitesearch" type="hidden"><input size="15" name="as_q" id="query" type="text"><img height="1" width="5" alt="" src="../skin/images/spacer.gif" class="spacer"><input name="Search" value="Search" type="submit">
<br>
<font face="Arial, Helvetica, Sans-serif" size="2" color="white">
                          the Apache Forrest site
                          
                          
                        </font></td><td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img alt="" border="0" height="10" width="9" src="../skin/images/search-left.gif"></td><td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td><img alt="" border="0" height="10" width="9" src="../skin/images/search-right.gif"></td>
</tr>
</table>
</form>
</td>
<!--================= end Search ==================--><td bgcolor="#294563"><img height="10" width="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" bgcolor="#294563" colspan="2">
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="6"><img alt="" height="8" width="6" src="../skin/images/spacer.gif"></td><td valign="bottom">
<table summary="non selected tab" style="height: 1.6em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="../skin/images/tab-left.gif"></td><td valign="middle" bgcolor="#B2C4E0"><a class="base-not-selected" href="../index.html">Welcome</a></td><td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="../skin/images/tab-right.gif"></td>
</tr>
<tr>
<td colspan="3" height="1"></td>
</tr>
</table>
</td><td width="6"><img alt="" height="8" width="6" src="../skin/images/spacer.gif"></td><td valign="bottom">
<table summary="non selected tab" style="height: 1.6em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="../skin/images/tab-left.gif"></td><td valign="middle" bgcolor="#B2C4E0"><a class="base-not-selected" href="../contrib.html">Project</a></td><td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="../skin/images/tab-right.gif"></td>
</tr>
<tr>
<td colspan="3" height="1"></td>
</tr>
</table>
</td><td width="6"><img alt="" height="8" width="6" src="../skin/images/spacer.gif"></td><td valign="bottom">
<table summary="selected tab" style="height: 1.8em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="../skin/images/tabSel-left.gif"></td><td valign="middle" bgcolor="#4C6C8F"><font color="#ffffff" size="2" face="Arial, Helvetica, Sans-serif"><b><a class="base-selected" href="../docs/your-project.html">Documentation</a></b></font></td><td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="../skin/images/tabSel-right.gif"></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td><td bgcolor="#294563"></td>
</tr>
<tr>
<td height="10" bgcolor="#4C6C8F" colspan="4">
<div class="level2tab">
<a class="base-selected" href="../docs/your-project.html">Core</a>&nbsp;|&nbsp;<a class="base-selected" href="../docs/forrestbot.html">ForrestBot</a>&nbsp;|&nbsp;<a class="base-selected" href="../docs/forrestbar.html">ForrestBar</a>
</div>
</td>
</tr>
</table>
<!--================= end Banner ==================-->
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<td rowspan="3" valign="top">
<table summary="blue line" border="0" cellpadding="0" cellspacing="0">
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td bgcolor="#CFDCED"><font color="#4C6C8F" size="4" face="Arial, Helvetica, Sans-serif">&nbsp;</font></td>
</tr>
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td>
<!--================= end left top NavBar ==================--><td bgcolor="#294563"><img width="1" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap" valign="top" bgcolor="#4C6C8F">
<!--================= start Menu items ==================-->
<div class="menu">
<ul>
<li>
<font color="#CFDCED">Documentation</font>
<ul>
    
<li>
<a href="../docs/your-project.html">Using Forrest</a>
</li>
    
<li>
<a href="../docs/validation.html">XML Validation</a>
</li>
    
<li>
<span class="sel"><font color="#ffcc00">Menus and Linking</font></span>
</li>
    
<li>
<a href="../docs/searching.html">Searching</a>
</li>
    
<li>
<a href="../docs/skin-package.html">Skin Packages</a>
</li>
    
    
<li>
<a href="../docs/forrest-contract.html">Our Contract</a>
</li>
    
<li>
<a href="../docs/compliance.html">Standards Compliance</a>
</li>
   
    
    
<li>
<font color="#CFDCED">Advanced Topics</font>
<ul>
      
<li>
<a href="../docs/catalog.html">Using DTD Catalogs</a>
</li>
      
<li>
<a href="../docs/sitemap-ref.html">Sitemap Reference</a>
</li>
      
<li>
<a href="../docs/cap.html">Sourcetype Action</a>
</li>
    
</ul>
</li>
    
    
<li>
<font color="#CFDCED">Upgrading</font>
<ul>
      
<li>
<a href="../docs/upgrading_06.html">Upgrading to 0.6</a>
</li>
      
<li>
<a href="../docs/upgrading_05.html">Upgrading to 0.5</a>
</li>
    
</ul>
</li>
  
</ul>
</li>
<li>
<font color="#CFDCED">SubProjects</font>
<ul>
    
<li>
<a href="../docs/forrestbar.html">ForrestBar</a>
</li>
    
<li>
<a href="../docs/forrestbot.html">Forrestbot</a>
</li>
  
</ul>
</li>
<li>
<font color="#CFDCED">References</font>
<ul>
    
<li>
<font color="#CFDCED">DTD documentation</font>
<ul>
        
<li>
<a href="../docs/dtd-docs.html">index</a>
</li>
        
<li>
<a href="../docs/document-v12.dtdx.html">document-v12</a>
</li>
        
<li>
<a href="../docs/howto-v12.dtdx.html">howto-v12</a>
</li> 
        
<li>
<a href="../docs/faq-v12.dtdx.html">faq-v12</a>
</li>           
    
</ul>
</li>
    
<li>
<a href="../docs/document-v12.html">document-v12</a>
</li>
    
<li>
<a href="../docs/wiki-sample.html">Wiki Reference</a>
</li>
    
<li>
<a href="../docs/oowriter.html">OpenOffice Writer</a>
</li>    
 
</ul>
</li>
<li>
<font color="#CFDCED">Older Docs</font>
<ul>
    
<li>
<a href="../docs/primer.html">Forrest Primer</a>
</li>
    
<li>
<a href="../docs/libre-intro.html">Libre</a>
</li>
    
<li>
<a href="../docs/dreams.html">Dream list</a>
</li>
  
</ul>
</li>
</ul>
</div>
<!--================= end Menu items ==================-->
</td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td bgcolor="#294563"><img width="1" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" align="left" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="../skin/images/menu-left.gif"></td><td bgcolor="#4C6C8F"><img height="10" width="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td valign="bottom" align="right" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="../skin/images/menu-right.gif"></td>
</tr>
<tr>
<td height="1" bgcolor="#294563"><img width="1" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<!--================= start middle NavBar ==================-->
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td align="left" width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td align="left" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td align="right" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end middle NavBar ==================-->
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td colspan="2" align="left" width="100%">
<div class="content">
<table class="title" summary="">
<tr>
<td valign="middle">
<h1>Menus and Linking</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="linking.pdf"><img alt="PDF" src="../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a></td>
</tr>
</table>
<ul class="minitoc">
<li>
<a href="#intro">Introduction</a>
</li>
<li>
<a href="#site">site.xml</a>
</li>
<li>
<a href="#menu_generation">Generating Menus</a>
<ul class="minitoc">
<li>
<a href="#tabs-external">Tabs for External Resources</a>
</li>
<li>
<a href="#selecting-entries">Selecting menu entries</a>
</li>
<li>
<a href="#other-menu-selection">Alternative menu selection mechanisms.</a>
<ul class="minitoc">
<li>
<a href="#dir-menu-selection">Directory-based selection</a>
</li>
<li>
<a href="#book-menu-selection">Specifying menus with book.xml</a>
</li>
</ul>
</li>
<li>
<a href="#tab-selection">Selecting the current tab</a>
</li>
</ul>
</li>
<li>
<a href="#toc-generation">Table of Contents Generation</a>
</li>
<li>
<a href="#linking">Linking systems</a>
<ul class="minitoc">
<li>
<a href="#direct-linking">Direct linking</a>
</li>
<li>
<a href="#indirect-linking">Indirect linking</a>
<ul class="minitoc">
<li>
<a href="#resolve-site-uris">Resolving site: URIs</a>
</li>
<li>
<a href="#resolve-ext-uris">ext: URIs: linking to external URLs</a>
</li>
<li>
<a href="#source-uris">Theory: source URIs</a>
</li>
<li>
<a href="#future-schemes">Future schemes</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#concept">Concept</a>
</li>
<li>
<a href="#implementation">Implementation</a>
</li>
</ul>
    
<a name="N10010"></a><a name="intro"></a>
<h3>Introduction</h3>
<div style="margin-left: 0 ; border: 2px">
<p>
        This document describes Forrest's internal URI space; how it is managed
        with <span class="codefrag">site.xml</span>, how menus are generated, and how various link schemes (site:,
        ext:) work.  An overview of the implementation is also provided.
      </p>
</div>

    
<a name="N1001D"></a><a name="site"></a>
<h3>site.xml</h3>
<div style="margin-left: 0 ; border: 2px">
<p>
        
<span class="codefrag">site.xml</span> is what we'd call a 'site map' if Cocoon hadn't already claimed
        that term. <span class="codefrag">site.xml</span> is a loosely structured XML file, acting as a map of the
        site's contents.  It provides a unique identifier (an XPath address)
        for 'nodes' of information in the website.  A 'node' of site information
        can be:
      </p>
<ul>
        
<li>A category of information, like 'the user guide'. A category may
          correspond to a directory, but that is not required.</li>
        
<li>A specific page, e.g. 'the FAQ page'</li>
        
<li>A specific section in a page, e.g. "the 'general' section of the FAQ
          page" (identified by <span class="codefrag">id="general"</span> attribute)</li>
      
</ul>
<p>
        In addition to providing fine-grained addressing of site info, <span class="codefrag">site.xml</span>
        allows <em>metadata</em> to be associated with each node, with
        attributes or child elements.  Most commonly, a <span class="codefrag">label</span>
        attribute is used to provide a text description of the node.
      </p>
<p>
        There are currently two applications of <span class="codefrag">site.xml</span>
      
</p>
<dl>
        
<dt>
<a href="#menu_generation">Menu generation</a>
</dt>
        
<dd>
<span class="codefrag">site.xml</span> is used to generate the menus for the HTML website.</dd>
        
<dt>
<a href="#semantic_linking">Indirect linking</a>
</dt>
        
<dd>
<span class="codefrag">site.xml</span> provides a basic aliasing mechanism for linking, e.g. one
          can write &lt;link href="site:changes"&gt; from anywhere in the site, and
          link to the 'changes' information node (translated to changes.html).
          More on this below.</dd>
      
</dl>
<p>
        Here is a sample site.xml, a stripped-down version from Forrest's
        own <a href="http://forrest.apache.org/">website</a>:
      </p>
<pre class="code">
        &lt;?xml version="1.0"?&gt;
        &lt;site label="Forrest" href="" tab="home"
          xmlns="http://apache.org/forrest/linkmap/1.0"&gt;

          &lt;about label="About"&gt;
            &lt;index label="Index" href="index.html"/&gt;
            &lt;license label="License" href="license.html"/&gt;
            &lt;your-project label="Using Forrest" href="your-project.html"&gt;
              &lt;new_content_type href="#adding_new_content_type"/&gt;
            &lt;/your-project&gt;
            &lt;linking label="Linking" href="linking.html"/&gt;
            &lt;changes label="Changes" href="changes.html"/&gt;
            &lt;todo label="Todo" href="todo.html"/&gt;
            &lt;live-sites label="Live sites" href="live-sites.html"/&gt;
          &lt;/about&gt;

          &lt;community label="Community" href="community/" tab="community"&gt;
            &lt;index label="About" href="index.html"/&gt;
            &lt;howto-samples label="How-To Samples" href="howto/" tab="howto"&gt;
              &lt;overview label="Overview" href="index.html"/&gt;
              &lt;single-page label="Single Page" href="v10/howto-v10.html"/&gt;
              &lt;multi-page label="Multi-Page" href="multi/"&gt;
                &lt;intro label="Intro" href="howto-multi.html"/&gt;
                &lt;step1 label="Step 1" href="step1.html"/&gt;
                &lt;step2 label="Step 2" href="step2.html"/&gt;
              &lt;/multi-page&gt;
            &lt;/howto-samples&gt;
          &lt;/community&gt;

          &lt;references label="References"&gt;
            &lt;gump label="Apache Gump" href="http://jakarta.apache.org/gump/"/&gt;
            &lt;cocoon label="Apache Cocoon" href="http://xml.apache.org/cocoon/"/&gt;
          &lt;/references&gt;

          &lt;external-refs&gt;
            &lt;mail-archive href="http://marc.theaimsgroup.com"/&gt;
            &lt;xml.apache.org href="http://xml.apache.org/"&gt;
              &lt;cocoon href="cocoon/"&gt;
                &lt;ml href="mail-lists.html"/&gt;
                &lt;actions href="userdocs/concepts/actions.html"/&gt;
              &lt;/cocoon&gt;
              &lt;forrest href="forrest/"/&gt;
              &lt;xindice href="xindice/"/&gt;
              &lt;fop href="fop/"/&gt;
            &lt;/xml.apache.org&gt;

            &lt;mail&gt;
              &lt;semantic-linking href="http://marc.theaimsgroup.com/?l=forrest-dev
                &amp;amp;m=103097808318773&amp;amp;w=2"/&gt;
            &lt;/mail&gt;
            &lt;cool-uris href="www.w3.org/Provider/Style/URI.html"/&gt;
            &lt;uri-rfc href="http://zvon.org/tmRFC/RFC2396/Output/index.html"/&gt;

          &lt;/external-refs&gt;

        &lt;/site&gt;
        </pre>
<p>As you can see, things are pretty free-form. The rules are as follows:</p>
<ul>
        
<li>The root element must be 'site', and normal content should be in the
          namespace <span class="codefrag">http://apache.org/forrest/linkmap/1.0</span>. Feel
          free to mix in your own content (RDF, dublin core, etc) under new
          namespaces</li>
        
<li>Element names are used as identifiers.  The <span class="codefrag">foo</span> in
          <span class="codefrag">site:foo</span> must therefore be a valid NMTOKEN.</li>
        
<li>Elements with <span class="codefrag">href</span> attributes can be used as identifiers
          in <span class="codefrag">site:</span> URIs</li>
        
<li>Relative href attribute contents are 'accumulated' by prepending hrefs
          from ancestor nodes</li>
        
<li>Elements without <span class="codefrag">label</span> attributes (and their children)
          are not displayed in the menu.</li>
        
<li>Elements below <span class="codefrag">external-refs</span> are mapped to the
          <span class="codefrag">ext:</span> scheme.  so <span class="codefrag">ext:cocoon/ml</span> becomes
          <span class="codefrag">http://xml.apache.org/cocoon/mail-lists.html</span>
</li>
      
</ul>
</div>

    
<a name="N100A5"></a><a name="menu_generation"></a>
<h3>Generating Menus</h3>
<div style="margin-left: 0 ; border: 2px">
<p>
        Two files are used to define a site's tabs and menu; <span class="codefrag">site.xml</span> and
        <span class="codefrag">tabs.xml</span>.  Both files are located in
        <span class="codefrag">src/documentation/content/xdocs/</span>.</p>
<p>Assume that our <span class="codefrag">tabs.xml</span> looked as follows:</p>
<pre class="code">
&lt;tabs ...&gt;
    &lt;tab id="home" label="Home" dir=""/&gt;
    &lt;tab id="community" label="Community" dir="community" indexfile="mailLists.html"/&gt;
    &lt;tab id="howto" label="How-Tos" dir="community/howto"/&gt;
&lt;/tabs&gt;
      </pre>
<p>Using the <span class="codefrag">site.xml</span> listed above, we would get these menus:</p>
<p>
        
<img alt="Menu generated from site.xml" src="images/menu.png">&nbsp;&nbsp;&nbsp;
        <img alt="Community menu generated from site.xml" src="images/menu2.png">&nbsp;&nbsp;&nbsp;
        <img alt="Howto menu generated from site.xml" src="images/menu3.png">
      </p>
<p>When using the <span class="codefrag">dir</span> attribute as above the value of the
      <span class="codefrag">indexfile</span> parameter is appended to the value of the 
      <span class="codefrag">dir</span> attribute (together with a preceding '/'). For example,
      the link for the community tab above is 
      <span class="codefrag">community/mailLists.html</span>. Note that <span class="codefrag">indexfile</span>
      defaults to <span class="codefrag">index.html</span> if no value is supplied. Therefore the
      link for the howto tab is <span class="codefrag">community/howto/index.html</span>.</p>
<a name="N100EE"></a><a name="tabs-external"></a>
<h4>Tabs for External Resources</h4>
<div style="margin-left: 0 ; border: 2px">
<p>You can make a tab point to an external resource by using the 
        <span class="codefrag">href</span> attribute instead of the <span class="codefrag">dir</span> attribute.
        The value of <span class="codefrag">href</span> should be the URI of the resource you wish 
        to link to. For example:</p>
<pre class="code">
&lt;tab id="apache" label="XML Apache" href="http://xml.apache.org/"/&gt;
        </pre>
<p>Unlike the <span class="codefrag">dir</span> attribute, the value of <span class="codefrag">href</span>
        is left unmodified by Forrest unless it is root-relative and obviously 
        specifies a directory (ends in '/'). In which case /index.html will be 
        added</p>
</div>
<a name="N1010E"></a><a name="selecting-entries"></a>
<h4>Selecting menu entries</h4>
<div style="margin-left: 0 ; border: 2px">
<p>Forrest decides which menu entries to display by examining the
          <span class="codefrag">tab</span> attributes in <span class="codefrag">site.xml</span>.  All <span class="codefrag">site.xml</span> entries with a
          <span class="codefrag">tab</span> equal to that of the current page are put in the
          menu.</p>
<p>Consider our <span class="codefrag">site.xml</span> example:</p>
<pre class="code">
&lt;site label="Forrest" href="" <strong>tab="home"</strong>
  xmlns="http://apache.org/forrest/linkmap/1.0"&gt;

  &lt;about label="About"&gt;
    &lt;index label="Index" href="index.html"/&gt;
    &lt;license label="License" href="license.html"/&gt;
    &lt;your-project label="Using Forrest" href="your-project.html"&gt;
      &lt;new_content_type href="#adding_new_content_type"/&gt;
    &lt;/your-project&gt;
    &lt;linking label="Linking" href="linking.html"/&gt;
    ....
  &lt;/about&gt;

  &lt;community label="Community" href="community/" <strong>tab="community"</strong>&gt;
    &lt;index label="About" href="index.html"/&gt;
    &lt;howto-samples label="How-To Samples" href="howto/" <strong>tab="howto"</strong>&gt;
      &lt;overview label="Overview" href="index.html"/&gt;
      &lt;single-page label="Single Page" href="v10/howto-v10.html"/&gt;
      &lt;multi label="Multi-Page" href="multi/"&gt;
        &lt;intro label="Intro" href="howto-multi.html"/&gt;
        &lt;step1 label="Step 1" href="step1.html"/&gt;
      ...</pre>
<p>
          Every <span class="codefrag">site.xml</span> node can potentially have a <span class="codefrag">tab</span> attribute.  If
          unspecified, nodes inherit the <span class="codefrag">tab</span> of their parent.  Thus
          everything in the <strong>&lt;about&gt;</strong> section has an implicit
          <span class="codefrag">tab="home"</span>.</p>
<div class="frame note">
<div class="label">Note</div>
<div class="content">You can see this by viewing your site's 
        <a href="abs-menulinks">abs-menulinks</a> pipeline in a
          browser.</div>
</div>
<p>Say that the user is viewing the <span class="codefrag">linking.html</span>
          page.  The <strong>&lt;linking&gt;</strong> node has an implicit tab
          value of <span class="codefrag">home</span>.  Forrest will select <em>all nodes with
            tab="home"</em>, and put them in the menu.
        </p>
</div>
<a name="N1015F"></a><a name="other-menu-selection"></a>
<h4>Alternative menu selection mechanisms.</h4>
<div style="margin-left: 0 ; border: 2px">
<p>
          The <span class="codefrag">tab</span> attribute-based scheme for selecting a menu's
          entries is not the only one, although it is the most flexible.  Here
          we describe a few alternatives.
        </p>
<a name="N1016B"></a><a name="dir-menu-selection"></a>
<h5>Directory-based selection</h5>
<div style="margin-left: 0 ; border: 2px">
<p>In this scheme, each tab corresponds to a directory within the
            site.  All content below that directory is included in the menu.</p>
<p>
            
<img alt="Directory-based site menu" src="images/dir-menu.png">&nbsp;&nbsp;&nbsp;
            <img alt="community/ directory menu" src="images/dir-menu2.png">&nbsp;&nbsp;&nbsp;
            <img alt="community/howto/ directory menu" src="images/dir-menu3.png">
          </p>
<p>
            To use this scheme:
          </p>
<ul>
            
<li>Edit <span class="codefrag">forrest.properties</span> and set
              <span class="codefrag">project.menu-scheme=directories</span>
</li>
            
<li>Remove the <span class="codefrag">id</span> attributes from <span class="codefrag">tabs.xml</span>
              entries.</li>
          
</ul>
</div>
<a name="N1019B"></a><a name="book-menu-selection"></a>
<h5>Specifying menus with book.xml</h5>
<div style="margin-left: 0 ; border: 2px">
<p>
            Historically, menus in Forrest have been generated from a
            <span class="codefrag">book.xml</span> file, one per directory.  This mechanism is
            still available, and if a <span class="codefrag">book.xml</span> is found, it will be
            used in preference to the <span class="codefrag">site.xml</span>-generated menu.  <span class="codefrag">book.xml</span>
            files can use <span class="codefrag">site:</span> URIs to ease the maintenance burden
            that led to book.xml's obsolescence.  In general, however, we
            recommend that users avoid <span class="codefrag">book.xml</span>.
          </p>
</div>
</div>
<a name="N101B8"></a><a name="tab-selection"></a>
<h4>Selecting the current tab</h4>
<div style="margin-left: 0 ; border: 2px">
<p>
          The tab selection algorithm is quite simple: the tab with the
          <span class="codefrag">id</span> which matches that of the current <span class="codefrag">site.xml</span>
          node is "selected". If you experience any problems, try to add a 
          <span class="codefrag">&lt;foo label="Foo" href="index.html"/&gt;</span> to 
          <span class="codefrag">site.xml</span>
        
</p>
</div>
</div>

    
<a name="N101CF"></a><a name="toc-generation"></a>
<h3>Table of Contents Generation</h3>
<div style="margin-left: 0 ; border: 2px">
<p>Each page can have an automatically generated table of contents. This
      is created from the titles of each section in your xdoc. By default only
      sections up to two levels deep are included and the table of contents is
      displayed at the top of the page. However, you can configure this
      behaviour in <span class="codefrag">src/documentation/skinconf.xml</span> using the <span class="codefrag">toc</span>
      element.</p>
<pre class="code">
&lt;toc level="2" location="page"/&gt;
      </pre>
<ul>
        
<li>
<strong><span class="codefrag">level</span></strong> - is the depth to which you
        want your table of contents to go. Setting it to 3 will therefore 
        include sections nested to 3 levels. Setting this to 0 will result in
        no table of contents being generated.</li>
        
<li>
<strong><span class="codefrag">location</span></strong> - indicates where you
        want the table of contents to be rendered. It can be set to one of
        three values:
          <ul>
            
<li>
<span class="codefrag">page</span> - the table of contents will be rendered
            at the top of the body of your page</li>
            
<li>
<span class="codefrag">menu</span> - the table of contents will be rendered
            in the menu to the left of the body of the page</li>
            
<li>
<span class="codefrag">menu, page</span> - table of contents will be rendered
            in both the page and the menu positions</li>
          
</ul>
        
</li>
      
</ul>
</div>
    
    
<a name="N10204"></a><a name="linking"></a>
<h3>Linking systems</h3>
<div style="margin-left: 0 ; border: 2px">
<a name="N1020A"></a><a name="direct-linking"></a>
<h4>Direct linking</h4>
<div style="margin-left: 0 ; border: 2px">
<p>
          In earlier versions of Forrest (and in similar systems), there has
          been only one URI space: that of the generated site.  If <span class="codefrag">index.xml</span> wants to
          link to <span class="codefrag">todo.xml</span> then <span class="codefrag">index.xml</span> would use
        </p>
<pre class="code">
          &lt;link href="todo.html"&gt;to-do list&lt;link&gt;
        </pre>
<p>
          The theoretical problem with this is that the content producer should
          not know or care how Forrest is going to render the source.  A URI
          should only <em>identify</em> a resource, not specify it's type
          [<a class="external" href="http://marc.theaimsgroup.com/?l=forrest-dev&m=103097808318773&w=2">mail ref</a>]
          [<a class="external" href="http://www.w3.org/Provider/Style/URI.html">cool URIs</a>]. In fact, as Forrest
          typically renders to multiple output formats (HTML and PDF), links in
          one of them (here, the PDF) are likely to break.
        </p>
</div>
<a name="N1022F"></a><a name="indirect-linking"></a>
<h4>Indirect linking</h4>
<div style="margin-left: 0 ; border: 2px">
<p>
          Forrest's solution is simple: instead of &lt;link href="todo.html"&gt;,
          write &lt;link href="site:todo"&gt;, where:
        </p>
<dl>
          
<dt>site</dt>
          
<dd>is a URI 'scheme'; a namespace that restricts
            the syntax and semantics of the rest of the URI
            [<a class="external" href="http://zvon.org/tmRFC/RFC2396/Output/index.html">rfc2396</a>].  The semantics of 'site' are
            "this identifier locates something in the site's XML sources".</dd>
          
<dt>todo</dt>
          
<dd>identifies the content in <span class="codefrag">todo.xml</span>, by reference to a
            'node' of content declared in <span class="codefrag">site.xml</span>.</dd>
        
</dl>
<p>
          We call this indirect, or <em>semantic</em> linking because instead of
          linking to a physical representation (todo.html), we've linked to the
          'idea' of "the todo file".  It doesn't matter where it physically lives;
          that will be sorted out by Forrest.
        </p>
<a name="N10257"></a><a name="resolve-site-uris"></a>
<h5>Resolving site: URIs</h5>
<div style="margin-left: 0 ; border: 2px">
<p>
            How exactly does <span class="codefrag">site:todo</span> get resolved?  A full answer
            is provided in the <a href="#implementation">implementation</a>
            section.  Essentially, the <span class="codefrag">todo</span> part has
            <span class="codefrag">/site//</span> prepended, and <span class="codefrag">/@href</span> appended, to
            form string <span class="codefrag">/site//todo/@href</span>.  This is
            then used as an XPath expression in <span class="codefrag">site.xml</span> identifying the string
            replacement, in this case <span class="codefrag">todo.html</span>.
          </p>
<p>
            Thus by modifying the XPath prefix and suffix, just about any XML
            format can be accommodated.
          </p>
<div class="frame note">
<div class="label">Note</div>
<div class="content">
            Actually, the XPath is applied to XML generated dynamically from
            <span class="codefrag">site.xml</span>.  The generated XML has @href's fully expanded ('absolutized')
            and ..'s added ('relativized') as needed.
          </div>
</div>
<p>
            Notice that the '//' allows us any degree of specificity when linking.
            In the sample <span class="codefrag">site.xml</span> above, both <span class="codefrag">site:new_content_type</span> and
            <span class="codefrag">site:about/your-project/new_content_type</span> identify the
            same node.  It is up to you to decide how specific to make links.  One
            nice benefit of link 'ambiguity' is that <span class="codefrag">site.xml</span> can be reorganized
            without breaking links.  For example, 'new_content_type' currently
            identifies a node in 'your-project'.  By leaving that fact unspecified
            in <span class="codefrag">site:new_content_type</span>, we are free to make
            'new_content_type' its own XML file, or a node in another file, in
            another category.
          </p>
</div>
<a name="N10295"></a><a name="resolve-ext-uris"></a>
<h5>ext: URIs: linking to external URLs</h5>
<div style="margin-left: 0 ; border: 2px">
<p>
            The <span class="codefrag">ext:</span> scheme was created partly to demonstrate the
            ease with which new schemes can be defined, and partly for practical
            use.  <span class="codefrag">ext:</span> URIs identify nodes in <span class="codefrag">site.xml</span> below the
            &lt;external-refs&gt; node.  By convention, nodes here link to URLs
            outside the website, and are not listed in the menu generated from
            <span class="codefrag">site.xml</span>.
          </p>
<p>Here is a <span class="codefrag">site.xml</span> snippet illustrating <span class="codefrag">external-refs</span>:</p>
<pre class="code">
            &lt;site&gt;
              ...
              &lt;external-refs&gt;
                &lt;mail-archive href="http://marc.theaimsgroup.com"/&gt;
                &lt;xml.apache.org href="http://xml.apache.org/"&gt;
                  &lt;cocoon href="cocoon/"&gt;
                    &lt;ml href="mail-lists.html"/&gt;
                    &lt;actions href="userdocs/concepts/actions.html"/&gt;
                  &lt;/cocoon&gt;
                &lt;/xml.apache.org&gt;
                &lt;forrest href="forrest/"/&gt;
                &lt;xindice href="xindice/"/&gt;
                &lt;fop href="fop/"/&gt;

                ...
              &lt;/external-refs&gt;
            &lt;/site&gt;
            </pre>
<p>
            As an example, &lt;link href="ext:cocoon/ml"&gt;
            generates the link
            <a class="external" href="http://cocoon.apache.org/2.1/mail-lists.html">http://xml.apache.org/cocoon/mail-lists.html</a>
          
</p>
<p>
            The general rules of <span class="codefrag">site.xml</span> and <span class="codefrag">site:</span> linking apply.
            Specifically, the @href aggregation makes defining large numbers of
            related URLs easy.
          </p>
</div>
<a name="N102C8"></a><a name="source-uris"></a>
<h5>Theory: source URIs</h5>
<div style="margin-left: 0 ; border: 2px">
<p>
            
<span class="codefrag">site:</span> URIs like <span class="codefrag">site:todo</span> are examples of
            <em>source</em> URIs, in contrast to the more usual
            <span class="codefrag">foo.html</span>-style URIs, which we here call
            <em>destination</em> URIs.  This introduces an important concept: that
            the <em>source</em> URI space exists and is independent of that of the
            generated site.  Furthermore, URIs (ie, links) are first-class objects,
            on par with XML documents, in that just as XML content is transformed,
            so are the links.  Within the source URI space, we can have all sorts of
            interesting schemes (person:, mail:, google:, java:, etc). These will
            all be translated into plain old <span class="codefrag">http:</span> or relative URIs
            in the destination URI space, just like exotic XML source formats are
            translated into plain old HTML in the output.
          </p>
</div>
<a name="N102E7"></a><a name="future-schemes"></a>
<h5>Future schemes</h5>
<div style="margin-left: 0 ; border: 2px">
<p>
            So far, <span class="codefrag">site:</span> and <span class="codefrag">ext:</span> schemes are defined.
            To give you some ideas on other things we'd like to implement (and
            we'd welcome help implementing), here are a few possibilities.
          </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
            
<tr>
<th colspan="1" rowspan="1">Scheme</th><th colspan="1" rowspan="1">Example 'From'</th><th colspan="1" rowspan="1">Example 'To'</th><th colspan="1" rowspan="1">Description</th>
</tr>
            
<tr>
              
<td colspan="1" rowspan="1">java</td>
              <td colspan="1" rowspan="1">java:org.apache.proj.SomeClass</td>
              <td colspan="1" rowspan="1"><span class="codefrag">../../apidocs/org/apache/proj/SomeClass.html</span></td>
              <td colspan="1" rowspan="1">
                Links to documentation for a Java class (typically generated by
                <span class="codefrag">javadoc</span>).
              </td>
            
</tr>
            
<tr>
              
<td colspan="1" rowspan="1">mail</td>
              <td colspan="1" rowspan="1">mail::&lt;Message-Id&gt;</td>
              <td colspan="1" rowspan="1"><span class="codefrag">http://marc.theaimsgroup.com?t=12345678</span></td>
              <td colspan="1" rowspan="1">
                Links to an email, identified by its <span class="codefrag">Message-Id</span>
                header. Any mail archive website could be used.
              </td>
            
</tr>
            
<tr>
              
<td colspan="1" rowspan="1">search</td>
              <td colspan="1" rowspan="1">search:&lt;searchterm&gt;</td>
              <td colspan="1" rowspan="1"><span class="codefrag">http://www.google.com/search?q=searchterm</span></td>
              <td colspan="1" rowspan="1">Link to set of results from a search engine</td>
            
</tr>
            
<tr>
              
<td colspan="1" rowspan="1">person</td>
              <td colspan="1" rowspan="1">person:JT, person:JT/blog etc</td>
              <td colspan="1" rowspan="1"><span class="codefrag">mailto:jefft&lt;at&gt;apache.org</span>,
                <span class="codefrag">http://www.webweavertech.com/jefft/weblog/</span>, etc:</td>
              <td colspan="1" rowspan="1">
                A <span class="codefrag">person:</span> scheme could be used, say, to insert an
                automatically obfuscated email address, or link to a URI in some
                way associated with that person.
              </td>
            
</tr>
          
</table>
<p>
            There are even more possibilities in specific environments.  In an
            intranet, a <span class="codefrag">project:XYZ</span> scheme could identify company
            project pages.  In a project like <a class="external" href="http://ant.apache.org/">Apache
              Ant</a>, each Task could be identified with
            <span class="codefrag">task:&lt;taskname&gt;</span>, eg <span class="codefrag">task:pathconvert</span>.
          </p>
</div>
</div>
</div>
    
<a name="N1038B"></a><a name="concept"></a>
<h3>Concept</h3>
<div style="margin-left: 0 ; border: 2px">
<p>
        The <span class="codefrag">site:</span> scheme and associated ideas for <span class="codefrag">site.xml</span> were
        originally described in <a class="external" href="http://marc.theaimsgroup.com/?l=forrest-dev&m=103444028129281&w=2">the 'linkmap' RT
          email</a> to the forrest-dev list (RT means 'random thought'; a
        Cocoon invention).   Only section 2 has been implemented, and there is
        still significant work required to implement the full system
        described.  In particular, there is much scope for automating the
        creation of <span class="codefrag">site.xml</span> (section 4).  However, what is currently implemented
        gains most of the advantages of the system.
      </p>
</div>
    
<a name="N103A2"></a><a name="implementation"></a>
<h3>Implementation</h3>
<div style="margin-left: 0 ; border: 2px">
<p>Full details on the implementation of
      <a href="../docs/sitemap-ref.html#linkrewriting_impl">link rewriting</a> and
      <a href="../docs/sitemap-ref.html#menu_generation_impl">menu generation</a> are available in
      the <a href="../docs/sitemap-ref.html">Sitemap Reference</a>
</p>
</div>

  
<div class="attribution">
<span class="version">
          version 1.13</span>
</div>
</div>
</td><td width="10"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1" bgcolor="#4C6C8F"><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"><a href="../skin/images/label.gif"></a><a href="../skin/images/page.gif"></a><a href="../skin/images/chapter.gif"></a><a href="../skin/images/chapter_open.gif"></a><a href="../skin/images/current.gif"></a></td>
</tr>
<tr>
<td colspan="2" bgcolor="#CFDCED" class="copyright" align="center"><font size="2" face="Arial, Helvetica, Sans-Serif"><a href="http://www.apache.org/licenses/LICENSE-2.0">
              Copyright &copy; 2002-2004&nbsp;
              The Apache Software Foundation.</a>
          All rights reserved.
          <script type="text/javascript" language="JavaScript"><!--
              document.write(" - "+"Last Published: " + document.lastModified);
            //  --></script></font></td>
</tr>
<tr>
<td colspan="2" align="left" bgcolor="#CFDCED" class="logos"></td>
</tr>
</table>
<!--================= end Footer ==================-->
</body>
</html>
